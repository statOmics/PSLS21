<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Lieven Clement and Jeroen Gilis" />


<title>Exercise 8.x: Additive linear model on the poison dataset - solution</title>

<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">PSLS21</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-chalkboard-teacher"></span>
     
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="01-intro.html">1. Introduction</a>
    </li>
    <li>
      <a href="02-concepts.html">2. Concepts</a>
    </li>
    <li>
      <a href="03-experimentalDesign.html">3. Experimental Design I</a>
    </li>
    <li>
      <a href="04-dataExploration.html">4. Data Exploration</a>
    </li>
    <li>
      <a href="05-statisticalInference.html">5.1 Statistical Inference 1</a>
    </li>
    <li>
      <a href="05-statisticalInference-twosampleT.html">5.2 Statistical Inference 2</a>
    </li>
    <li>
      <a href="06-linearRegression.html">6. Linear Regression</a>
    </li>
    <li>
      <a href="07-Anova.html">7. Analysis of Variance</a>
    </li>
    <li>
      <a href="08-MultipleRegression.html">8. Multiple Regression</a>
    </li>
    <li>
      <a href="08-MultipleRegression-SpecificDesigns.html">8.2 Multiple Regression: Factorial Designs</a>
    </li>
    <li>
      <a href="08-experimentalDesignII.html">8.3. Experimental Design II</a>
    </li>
    <li>
      <a href="08-experimentalDesignIII.html">8.4. Experimental Design II</a>
    </li>
    <li>
      <a href="09-NonparametericStatistics-WilcoxonMannWithney.html">9.1. Nonparametric Statistics 1</a>
    </li>
    <li>
      <a href="09-NonparametericStatistics-KruskalWallis.html">9.2. Nonparametric Statistics 2</a>
    </li>
    <li>
      <a href="10-categoricalDataAnalysis.html">10. Categorical Data Analysis</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-laptop"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="04_exercises.html">4. Data Exploration</a>
    </li>
    <li>
      <a href="05_exercises.html">5. Statistical inference</a>
    </li>
    <li>
      <a href="06_exercises.html">6. Simple linear regression</a>
    </li>
    <li>
      <a href="07_exercises.html">7. ANOVA</a>
    </li>
    <li>
      <a href="08_exercises.html">8. Multiple linear regression</a>
    </li>
    <li>
      <a href="09_exercises.html">9. Non-parametric statistics</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/statOmics/PSLS21">
    <span class="fab fa-github"></span>
     
  </a>
</li>
<li>
  <a href="http://statomics.github.io/">statOmics</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Exercise 8.x: Additive linear model on the poison dataset - solution</h1>
<h4 class="author">Lieven Clement and Jeroen Gilis</h4>
<h4 class="date">statOmics, Ghent University (<a href="https://statomics.github.io" class="uri">https://statomics.github.io</a>)</h4>

</div>


<div id="fish-tank-dataset" class="section level1">
<h1><span class="header-section-number">1</span> Fish tank dataset</h1>
<p>In this experiment, 96 fish (dojofish, goldfish and zebrafish) were placed separately in a tank with two liters of water and a certain dose (in mg) of the poison EI-43,064. The resistance of the fish against the poison was measured as the amount of minutes the fish survived after being exposed to the poison (<code>Surv_time</code>, in minutes). Additionally, the weight of each fish was measured.</p>
</div>
<div id="goal" class="section level1">
<h1><span class="header-section-number">2</span> Goal</h1>
<p>The research goal is to study the association between the dose of the poison that was administered to the fish and their survival time.</p>
<p>Load libraries</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co">#install.packages(&quot;GGally&quot;)</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="kw">library</span>(GGally)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw">library</span>(car)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="kw">library</span>(multcomp)</span></code></pre></div>
</div>
<div id="import-the-data" class="section level1">
<h1><span class="header-section-number">3</span> Import the data</h1>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>poison &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/statOmics/PSLS21/data/poison.csv&quot;</span>)</span></code></pre></div>
</div>
<div id="data-tidying" class="section level1">
<h1><span class="header-section-number">4</span> Data tidying</h1>
<p>We can see a couple of things in the data that can be improved:</p>
<ol style="list-style-type: decimal">
<li><p>Capitalise the fist column name</p></li>
<li><p>Set the Species column as a factor</p></li>
<li><p>Change the species factor levels from 0, 1 and 2 to Dojofish, Goldfish and Zebrafish. <em>Hint</em>: use the <code>fct_recode</code> function.</p></li>
<li><p>In previous analysis on this dataset (<code>Simple linear regression session</code>), we performed a log-transformation on the response variable <code>Surv_time</code> to meet the normality and homoscedasticity assumptions of the linear model. Here, we will immediately work with log-transformed survival times; store these in the new variable <code>log2Surv_time</code> and remove the non-transformed values.</p></li>
</ol>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>poison &lt;-<span class="st"> </span>poison <span class="op">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="st">  </span><span class="kw">rename</span>(<span class="st">&quot;Species&quot;</span> =<span class="st"> &quot;species&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Species =</span> <span class="kw">as.factor</span>(Species)) <span class="op">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Species =</span> <span class="kw">fct_recode</span>(Species, <span class="dt">Dojofish =</span> <span class="st">&quot;0&quot;</span>, <span class="dt">Goldfish =</span> <span class="st">&quot;1&quot;</span>, <span class="dt">Zebrafish =</span> <span class="st">&quot;2&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">log2Surv_time =</span> <span class="kw">log2</span>(Surv_time)) <span class="op">%&gt;%</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">!</span>Surv_time)</span>
<span id="cb3-7"><a href="#cb3-7"></a></span>
<span id="cb3-8"><a href="#cb3-8"></a>poison</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Species"],"name":[1],"type":["fct"],"align":["left"]},{"label":["Weight"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Dose"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["log2Surv_time"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"Dojofish","2":"1.884359","3":"1.0","4":"1.7913944"},{"1":"Zebrafish","2":"1.732261","3":"1.1","4":"1.0775281"},{"1":"Goldfish","2":"2.830895","3":"1.2","4":"3.5133810"},{"1":"Zebrafish","2":"1.748562","3":"1.3","4":"0.8648822"},{"1":"Dojofish","2":"2.114166","3":"1.4","4":"1.7126482"},{"1":"Dojofish","2":"1.854602","3":"1.5","4":"1.5634296"},{"1":"Zebrafish","2":"1.215184","3":"1.6","4":"0.8866586"},{"1":"Goldfish","2":"2.054411","3":"1.7","4":"3.0098611"},{"1":"Dojofish","2":"1.801606","3":"1.8","4":"0.7264799"},{"1":"Goldfish","2":"2.501205","3":"1.9","4":"2.9913940"},{"1":"Dojofish","2":"1.912098","3":"2.0","4":"1.4300631"},{"1":"Goldfish","2":"1.782304","3":"2.1","4":"1.5184989"},{"1":"Dojofish","2":"2.032760","3":"1.0","4":"2.5984588"},{"1":"Dojofish","2":"2.263284","3":"1.1","4":"1.8107746"},{"1":"Zebrafish","2":"1.819726","3":"1.2","4":"1.4816565"},{"1":"Dojofish","2":"1.924464","3":"1.3","4":"1.7921807"},{"1":"Dojofish","2":"2.153471","3":"1.4","4":"1.6704941"},{"1":"Dojofish","2":"2.171603","3":"1.5","4":"1.9964936"},{"1":"Zebrafish","2":"1.543050","3":"1.6","4":"1.6332875"},{"1":"Dojofish","2":"2.023775","3":"1.7","4":"1.2161339"},{"1":"Goldfish","2":"2.158629","3":"1.8","4":"1.7374393"},{"1":"Goldfish","2":"2.337289","3":"1.9","4":"2.4348110"},{"1":"Goldfish","2":"1.900762","3":"2.0","4":"1.4145767"},{"1":"Dojofish","2":"2.028244","3":"2.1","4":"1.3091564"},{"1":"Goldfish","2":"2.159808","3":"1.0","4":"2.9603436"},{"1":"Dojofish","2":"1.819958","3":"1.1","4":"1.5203981"},{"1":"Goldfish","2":"1.999414","3":"1.2","4":"2.4534359"},{"1":"Goldfish","2":"2.073964","3":"1.3","4":"2.7024991"},{"1":"Goldfish","2":"2.058199","3":"1.4","4":"2.5106215"},{"1":"Zebrafish","2":"1.826108","3":"1.5","4":"1.2497287"},{"1":"Zebrafish","2":"1.715282","3":"1.6","4":"1.0572111"},{"1":"Goldfish","2":"2.482385","3":"1.7","4":"3.0336515"},{"1":"Goldfish","2":"2.224457","3":"1.8","4":"2.8006819"},{"1":"Dojofish","2":"2.780534","3":"1.9","4":"1.9370554"},{"1":"Dojofish","2":"1.874389","3":"2.0","4":"0.5591844"},{"1":"Dojofish","2":"2.405112","3":"2.1","4":"1.4068060"},{"1":"Goldfish","2":"2.252743","3":"1.0","4":"3.2521060"},{"1":"Dojofish","2":"2.183263","3":"1.1","4":"1.8067023"},{"1":"Goldfish","2":"2.454223","3":"1.2","4":"3.4462099"},{"1":"Dojofish","2":"2.529784","3":"1.3","4":"1.7155055"},{"1":"Zebrafish","2":"1.404543","3":"1.4","4":"1.3389600"},{"1":"Goldfish","2":"1.919328","3":"1.5","4":"1.9267483"},{"1":"Dojofish","2":"2.180245","3":"1.6","4":"1.3055830"},{"1":"Goldfish","2":"2.208250","3":"1.7","4":"2.0947343"},{"1":"Dojofish","2":"1.935201","3":"1.8","4":"0.9364046"},{"1":"Goldfish","2":"2.069835","3":"1.9","4":"2.4184380"},{"1":"Dojofish","2":"2.461620","3":"2.0","4":"1.0728604"},{"1":"Zebrafish","2":"2.062654","3":"2.1","4":"0.4336656"},{"1":"Dojofish","2":"2.339549","3":"1.0","4":"3.2262044"},{"1":"Zebrafish","2":"1.812377","3":"1.1","4":"2.0846235"},{"1":"Goldfish","2":"2.254900","3":"1.2","4":"2.6337127"},{"1":"Dojofish","2":"2.068002","3":"1.3","4":"1.2162506"},{"1":"Goldfish","2":"2.389707","3":"1.4","4":"2.9846169"},{"1":"Goldfish","2":"2.497137","3":"1.5","4":"3.4589805"},{"1":"Goldfish","2":"2.307549","3":"1.6","4":"2.1832461"},{"1":"Dojofish","2":"2.089716","3":"1.7","4":"1.0297561"},{"1":"Dojofish","2":"2.060077","3":"1.8","4":"1.8128863"},{"1":"Goldfish","2":"2.558311","3":"1.9","4":"2.6319280"},{"1":"Dojofish","2":"2.075058","3":"2.0","4":"0.7084601"},{"1":"Goldfish","2":"1.840242","3":"2.1","4":"1.6135227"},{"1":"Dojofish","2":"1.585098","3":"1.0","4":"1.5635633"},{"1":"Goldfish","2":"2.389859","3":"1.1","4":"2.6840840"},{"1":"Dojofish","2":"2.384177","3":"1.2","4":"2.8585554"},{"1":"Goldfish","2":"2.464393","3":"1.3","4":"2.7684338"},{"1":"Dojofish","2":"2.255311","3":"1.4","4":"1.3666770"},{"1":"Goldfish","2":"2.257577","3":"1.5","4":"2.2815638"},{"1":"Goldfish","2":"1.931530","3":"1.6","4":"1.8010266"},{"1":"Zebrafish","2":"1.585569","3":"1.7","4":"0.3944351"},{"1":"Dojofish","2":"2.290878","3":"1.8","4":"1.5919838"},{"1":"Goldfish","2":"2.475834","3":"1.9","4":"2.9523200"},{"1":"Zebrafish","2":"1.658319","3":"2.0","4":"0.6320039"},{"1":"Zebrafish","2":"1.777013","3":"2.1","4":"0.9965818"},{"1":"Zebrafish","2":"1.802350","3":"1.0","4":"0.6468299"},{"1":"Dojofish","2":"2.220584","3":"1.1","4":"2.3998886"},{"1":"Goldfish","2":"2.391795","3":"1.2","4":"3.7290047"},{"1":"Dojofish","2":"2.066648","3":"1.3","4":"1.4367386"},{"1":"Dojofish","2":"1.976426","3":"1.4","4":"1.4519491"},{"1":"Dojofish","2":"1.994567","3":"1.5","4":"2.1620821"},{"1":"Goldfish","2":"2.094764","3":"1.6","4":"1.9271531"},{"1":"Zebrafish","2":"1.531822","3":"1.7","4":"0.8917318"},{"1":"Goldfish","2":"2.292861","3":"1.8","4":"1.6701437"},{"1":"Dojofish","2":"2.078708","3":"1.9","4":"1.6801749"},{"1":"Goldfish","2":"2.605055","3":"2.0","4":"2.3864906"},{"1":"Goldfish","2":"2.458649","3":"2.1","4":"2.2651848"},{"1":"Zebrafish","2":"1.892714","3":"1.0","4":"2.0918369"},{"1":"Zebrafish","2":"1.428462","3":"1.1","4":"1.9097209"},{"1":"Dojofish","2":"2.582141","3":"1.2","4":"2.2998343"},{"1":"Goldfish","2":"1.874957","3":"1.3","4":"1.3660956"},{"1":"Goldfish","2":"2.655126","3":"1.4","4":"2.9447235"},{"1":"Goldfish","2":"1.881216","3":"1.5","4":"1.8227677"},{"1":"Dojofish","2":"2.331042","3":"1.6","4":"2.1906231"},{"1":"Dojofish","2":"2.360538","3":"1.7","4":"2.5006866"},{"1":"Zebrafish","2":"1.763365","3":"1.8","4":"1.4694896"},{"1":"Goldfish","2":"2.492774","3":"1.9","4":"2.3720138"},{"1":"Dojofish","2":"2.027935","3":"2.0","4":"1.4414622"},{"1":"Zebrafish","2":"1.890602","3":"2.1","4":"1.0940989"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="data-exploration-extensive" class="section level1">
<h1><span class="header-section-number">5</span> Data exploration (extensive)</h1>
<p>Prior to the analysis, we should explore our data. We have a rather complex dataset: as discussed in the <strong>session on simple linear regression session</strong>, we can imagine how the (log2) survival time of the fish not only depends on the dose of poison that was administered, but also on the weight of the fish and the fish species.</p>
<p>To start our data exploration, we will make use of the <code>ggpairs</code> function of the <code>GGally</code> R package. This function will generate a visualization containing multiple panels, which display (1) univariate plots of the different variables in our dataset, (2) bivariate plots and (3) correlation coefficients between the different variables.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>poison <span class="op">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="st">  </span>ggpairs <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="08_x_poison1_sol_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Based on these plots, we observe that:</p>
<ul>
<li><p>The survival time seems to be associated with dose, fish weight and species.</p></li>
<li><p>The association between weight and survival time is very strong and positive.</p></li>
<li><p>Species 2 (gold fish) are more resistant to the poison.</p></li>
<li><p>There is an association between weight and species.</p></li>
</ul>
<p>Knowing this, we now make additional relevant visualizations.</p>
<p>First, make a scatterplot that displays the association between poison dose and log2 survival time. To check if this association could be linear, we fit a linear regression line and a smooth “loess” line through the data cloud.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>poison <span class="op">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Dose,<span class="dt">y=</span>log2Surv_time)) <span class="op">+</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="st">  </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>) <span class="op">+</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&#39;lm&#39;</span>,<span class="dt">col=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Survival time (log2 min)&quot;</span>) <span class="op">+</span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Dose (mg)&quot;</span>) <span class="op">+</span></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="08_x_poison1_sol_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>The linear regression line (black) is a good approximation of the best fitting smooth line (blue) through the data. Based on this figure, it seems realistic to suggest a linear relationship between dose and survival, where higher doses have lower (log2) survival times.</p>
<p>However, this plot is missing the effect that the other explanatory variables, fish weight and species, may have on the relationship between dose and survival time. To assess the effect of species, we may color each dot in the above scatterplot according to species. In addition, we may fit a separate linear regression line for each species.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>poison <span class="op">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Dose, <span class="dt">y =</span> log2Surv_time, <span class="dt">col=</span>Species)) <span class="op">+</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;darkgoldenrod&quot;</span>, <span class="st">&quot;black&quot;</span>)) <span class="op">+</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="st">  </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span><span class="co"># se = FALSE omits confidence </span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="st">  </span><span class="co"># interval around regression line to make to plot less cluttered</span></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Survival time (log2 min)&quot;</span>) <span class="op">+</span></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Dose (mg)&quot;</span>) <span class="op">+</span></span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Association between dose and survival time - per species&quot;</span>) <span class="op">+</span></span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="08_x_poison1_sol_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>We indeed observe a strong influence of species on the survival time. Clearly, zebrafish have the lowest survival time, whereas goldfish have the highest survival time. However, we also see that the slopes of the different regression lines are very similar between the different species, suggesting a limited interaction of the species effect and the relationship between dose and survival time <strong>(see later theory session on interactions).</strong></p>
<p>Next, we make a scatterplot to visualize the relationship between fish weight and survival time. We again fit a smooth “loess” curve through the data cloud. Wee additionally color the observation according to species.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>poison <span class="op">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Weight, <span class="dt">y =</span> log2Surv_time, <span class="dt">col =</span> Species)) <span class="op">+</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;darkgoldenrod&quot;</span>, <span class="st">&quot;black&quot;</span>)) <span class="op">+</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="st">  </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>) <span class="op">+</span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Survival time (log2 min)&quot;</span>) <span class="op">+</span></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Weight&quot;</span>) <span class="op">+</span></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Association between weight and survival time&quot;</span>) <span class="op">+</span></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="08_x_poison1_sol_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>We observe a clear, positive relationship between fish weight and survival time, with heavier fish living longer than lighter fish. We also observe that fish weight is associated with fish species, with zebrafish being the lightest fish, on average. Wee may visualize this relationship more clearly using boxplots</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>poison <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Species, <span class="dt">y =</span> Weight, <span class="dt">col =</span> Species)) <span class="op">+</span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">outlier.shape =</span> <span class="ot">NA</span>) <span class="op">+</span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="st">  </span><span class="kw">geom_jitter</span>() <span class="op">+</span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;darkgoldenrod&quot;</span>, <span class="st">&quot;black&quot;</span>)) <span class="op">+</span></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Weigth (g)&quot;</span>) <span class="op">+</span></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Association between species and weight&quot;</span>) <span class="op">+</span></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="08_x_poison1_sol_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>Next, we maay assess the association between species and log2 survival time using boxplots.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>poison <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Species, <span class="dt">y =</span> log2Surv_time, <span class="dt">col =</span> Species)) <span class="op">+</span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">outlier.shape =</span> <span class="ot">NA</span>) <span class="op">+</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="st">  </span><span class="kw">geom_jitter</span>() <span class="op">+</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;darkgoldenrod&quot;</span>, <span class="st">&quot;black&quot;</span>)) <span class="op">+</span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Survival time (log2 min)&quot;</span>) <span class="op">+</span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Association between species and survival time&quot;</span>) <span class="op">+</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="08_x_poison1_sol_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>There is a clear association between species and log2 survival time. However, not that the relationship between species and survival time is <em>confounded</em> with the effect of weight!</p>
<p>Finally, there is one additional, less expected relationship between the different variables in the data. We make a scaatterplot for Dose and weight.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>poison <span class="op">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Dose, <span class="dt">y =</span> Weight)) <span class="op">+</span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Association between dose and weight&quot;</span>) <span class="op">+</span></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="st">  </span><span class="kw">stat_summary</span>(</span>
<span id="cb10-7"><a href="#cb10-7"></a>    <span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb10-8"><a href="#cb10-8"></a>    <span class="dt">fun.y =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb10-9"><a href="#cb10-9"></a>    <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb10-10"><a href="#cb10-10"></a>    <span class="dt">size =</span> <span class="dv">4</span>,</span>
<span id="cb10-11"><a href="#cb10-11"></a>    <span class="dt">shape =</span> <span class="dv">24</span>,</span>
<span id="cb10-12"><a href="#cb10-12"></a>    <span class="dt">fill =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: `fun.y` is deprecated. Use `fun` instead.</code></pre>
<p><img src="08_x_poison1_sol_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>We additionally observe that the average weight of the fish not uniform for the different dose that were administered. This can be explained by the fact that the experimental design was not balanced with respect to species and dose. More specifically, each dose was administered to 8 fish,</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">colSums</span>(<span class="kw">table</span>(poison<span class="op">$</span>Species, poison<span class="op">$</span>Dose))</span></code></pre></div>
<pre><code>##   1 1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9   2 2.1 
##   8   8   8   8   8   8   8   8   8   8   8   8</code></pre>
<p>however, the distribution of species across the different doses is variable.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw">table</span>(poison<span class="op">$</span>Species, poison<span class="op">$</span>Dose)</span></code></pre></div>
<pre><code>##            
##             1 1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9 2 2.1
##   Dojofish  4   4   2   4   4   3   2   3   4   2 5   2
##   Goldfish  2   1   5   3   3   4   3   3   3   6 2   3
##   Zebrafish 2   3   1   1   1   1   3   2   1   0 1   3</code></pre>
<p>However, even if we would subset the data to e.g. contain only dojofish, the fish weights are still not nicely uniform accros the different poison dosages (due to random fluctions).</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>poison <span class="op">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="st">  </span><span class="kw">filter</span>(Species <span class="op">==</span><span class="st"> &quot;Dojofish&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Dose, <span class="dt">y =</span> Weight)) <span class="op">+</span></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Association between dose and weight&quot;</span>) <span class="op">+</span></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="st">  </span><span class="kw">stat_summary</span>(</span>
<span id="cb16-8"><a href="#cb16-8"></a>    <span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb16-9"><a href="#cb16-9"></a>    <span class="dt">fun.y =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb16-10"><a href="#cb16-10"></a>    <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb16-11"><a href="#cb16-11"></a>    <span class="dt">size =</span> <span class="dv">4</span>,</span>
<span id="cb16-12"><a href="#cb16-12"></a>    <span class="dt">shape =</span> <span class="dv">24</span>,</span>
<span id="cb16-13"><a href="#cb16-13"></a>    <span class="dt">fill =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: `fun.y` is deprecated. Use `fun` instead.</code></pre>
<p><img src="08_x_poison1_sol_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>In conclusion, we see that all three explanatory variables (dose, species and weight) seem to have an effect on the log2 survival time. In addition, these explanatory variable or also not independent. As such, we should try to come up with a model that accomodates these different effects.</p>
<p>Ideally, we should construct a model that accounts for all the different associations observed in the data exploration. Such model should</p>
<ul>
<li><p>model the association between <code>Dose</code> and <code>log2 survival time</code>, while</p></li>
<li><p>accounting for the <code>species</code> effect,</p></li>
<li><p>accounting for the <code>weight</code> effect,</p></li>
<li><p>accounting for the fact that the association between <code>Dose</code> and <code>log2 survival time</code> may be different for different <code>species</code>.</p></li>
<li><p>and accounting for the fact that the association between <code>Dose</code> and <code>log2 survival time</code> may be different for fish of different <code>weight</code>.</p></li>
</ul>
<p><strong>By the time of the last exercise session in this series, we will learn how</strong> <strong>to construct such a model. For now, we will simplify the research question</strong> <strong>by reducing the dataset to contain only a single fish species, the</strong> <strong>dojofish, i.e.:</strong></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>poison_dojo &lt;-<span class="st"> </span>poison <span class="op">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="st">    </span><span class="kw">filter</span>(Species <span class="op">==</span><span class="st"> &quot;Dojofish&quot;</span>)</span></code></pre></div>
<p><strong>For demonstrational purposes, we will analyse this reduced dataset with</strong> <strong>three different strategies with increasing complexity:</strong></p>
<p><strong>1. a simple linear regression model (insufficient)</strong> <strong>2. an additive linear regression model (insufficient)</strong> <strong>3. a linear regression model with interaction</strong></p>
</div>
<div id="simple-linear-regression-insufficient" class="section level1">
<h1><span class="header-section-number">6</span> Simple linear regression (insufficient)</h1>
<p>This is the same regression model that we have already fit in the exercise session on simple linear regression, with <code>Dose</code> as the only explanatory variable for <code>log2Surv_time</code>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># fit a linear regression model with &#39;Surv_time&#39; as response variable and</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="co"># &#39;Dose&#39; as predictor variabele</span></span>
<span id="cb19-3"><a href="#cb19-3"></a>lm_simple &lt;-<span class="st"> </span><span class="kw">lm</span>(log2Surv_time <span class="op">~</span><span class="st"> </span>Dose, <span class="dt">data=</span>poison_dojo) </span>
<span id="cb19-4"><a href="#cb19-4"></a></span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="co">## display the diagnostic plots of the model</span></span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb19-7"><a href="#cb19-7"></a><span class="kw">plot</span>(lm_simple)</span></code></pre></div>
<p><img src="08_x_poison1_sol_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<ol style="list-style-type: decimal">
<li>The independence assumption not met, given that we expect that fish of similar weight will have a similar association between dose and survival time. <strong>For now, we will ignore this problem.</strong></li>
<li>The linearity assumption is <strong>met</strong>.</li>
<li>The normality assumption is <strong>met</strong>.</li>
<li>The homoscedasticity assumption is <strong>met</strong>.</li>
</ol>
<p>Finally, we look at the output of the model.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">summary</span>(lm_simple)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log2Surv_time ~ Dose, data = poison_dojo)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.6891 -0.3804 -0.1076  0.3452  1.0856 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   3.0469     0.3462   8.800 1.33e-10 ***
## Dose         -0.9063     0.2208  -4.104 0.000215 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4828 on 37 degrees of freedom
## Multiple R-squared:  0.3128, Adjusted R-squared:  0.2942 
## F-statistic: 16.84 on 1 and 37 DF,  p-value: 0.0002146</code></pre>
<p>Or for an interpretation at the original scale (minutes in stead of log2 minutes):</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="dv">2</span><span class="op">^</span>(lm_simple<span class="op">$</span>coef)[<span class="st">&quot;Dose&quot;</span>]</span></code></pre></div>
<pre><code>##      Dose 
## 0.5335551</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="dv">2</span><span class="op">^</span>(<span class="kw">confint</span>(lm_simple))[<span class="dv">2</span>,<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [1] 0.3912681</code></pre>
<p>There is an extremely significant effect of the poison dose on the log2-transformed survival time of dojofish (p-value = 0.000215). For each extra milligram of poison administered, the geometric mean of survival time will decrease by a factor of 0.534, (95% CI [0.391, 0.728]).</p>
<p>However, we know we have to be very careful with these results, since we did not include weight as a covariate to our model!</p>
</div>
<div id="analysis-with-additive-effect-for-weight" class="section level1">
<h1><span class="header-section-number">7</span> Analysis with additive effect for weight</h1>
<div id="model-specification" class="section level2">
<h2><span class="header-section-number">7.1</span> Model specification</h2>
<p>In a fist attempt to account for the effect of <code>weight</code>, we may add the <code>weight</code> variable as an additional covariate to our linear regression model, such that</p>
<p><span class="math display">\[
y_i=\beta_0+\beta_d x_d + \beta_g x_g + \epsilon_i,
\]</span></p>
<p>with <span class="math inline">\(\epsilon_i \text{ i.i.d. } N(0,\sigma^2)\)</span>.</p>
</div>
<div id="assumptions" class="section level2">
<h2><span class="header-section-number">7.2</span> Assumptions</h2>
<p>The model will again be fit to allow for assessing the model assumptions</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>lm_additive &lt;-<span class="st"> </span><span class="kw">lm</span>(log2Surv_time <span class="op">~</span><span class="st"> </span>Dose <span class="op">+</span><span class="st"> </span>Weight, <span class="dt">data =</span> poison_dojo)</span>
<span id="cb26-2"><a href="#cb26-2"></a></span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb26-4"><a href="#cb26-4"></a><span class="kw">plot</span>(lm_additive)</span></code></pre></div>
<p><img src="08_x_poison1_sol_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>The assumption of independence (!), linearity and homoscedasticity are met.</p>
<p>Arguably, there might be some deviation from normality in the left tail of the distribution. However, when we would simulate data under the normality assumption, it seems that deviations of this size may be expected when normality is met:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="kw">set.seed</span>(<span class="dv">1406</span>)</span>
<span id="cb27-2"><a href="#cb27-2"></a>nobs &lt;-<span class="st"> </span><span class="kw">nrow</span>(poison_dojo)</span>
<span id="cb27-3"><a href="#cb27-3"></a></span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="kw">data.frame</span>(</span>
<span id="cb27-5"><a href="#cb27-5"></a>  <span class="dt">y =</span> <span class="kw">c</span>(lm_additive<span class="op">$</span>res,</span>
<span id="cb27-6"><a href="#cb27-6"></a>        <span class="kw">rnorm</span>(nobs<span class="op">*</span><span class="dv">8</span>,</span>
<span id="cb27-7"><a href="#cb27-7"></a>              <span class="dt">sd =</span> <span class="kw">sigma</span>(lm_additive)</span>
<span id="cb27-8"><a href="#cb27-8"></a>             )</span>
<span id="cb27-9"><a href="#cb27-9"></a>      ),</span>
<span id="cb27-10"><a href="#cb27-10"></a>  <span class="dt">label =</span> <span class="kw">rep</span>(</span>
<span id="cb27-11"><a href="#cb27-11"></a>              <span class="kw">c</span>(<span class="st">&quot;original data&quot;</span>,</span>
<span id="cb27-12"><a href="#cb27-12"></a>                <span class="kw">paste0</span>(<span class="st">&quot;simulation &quot;</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>)),</span>
<span id="cb27-13"><a href="#cb27-13"></a>              <span class="dt">each =</span> nobs)) <span class="op">%&gt;%</span></span>
<span id="cb27-14"><a href="#cb27-14"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">sample =</span> y)) <span class="op">+</span></span>
<span id="cb27-15"><a href="#cb27-15"></a><span class="st">  </span><span class="kw">geom_qq</span>() <span class="op">+</span></span>
<span id="cb27-16"><a href="#cb27-16"></a><span class="st">  </span><span class="kw">geom_qq_line</span>() <span class="op">+</span></span>
<span id="cb27-17"><a href="#cb27-17"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>label) <span class="op">+</span></span>
<span id="cb27-18"><a href="#cb27-18"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="08_x_poison1_sol_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>As such, all assumptions for linear regression are met.</p>
</div>
<div id="inference" class="section level2">
<h2><span class="header-section-number">7.3</span> Inference</h2>
<p>We then inspect the results.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="kw">summary</span>(lm_additive)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log2Surv_time ~ Dose + Weight, data = poison_dojo)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.59629 -0.33110 -0.06836  0.32507  0.83315 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   0.8294     0.6457   1.285 0.207119    
## Dose         -0.9590     0.1888  -5.081 1.17e-05 ***
## Weight        1.0783     0.2792   3.862 0.000451 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4116 on 36 degrees of freedom
## Multiple R-squared:  0.5141, Adjusted R-squared:  0.4871 
## F-statistic: 19.04 on 2 and 36 DF,  p-value: 2.282e-06</code></pre>
</div>
<div id="interpretation-of-model-parameters" class="section level2">
<h2><span class="header-section-number">7.4</span> Interpretation of model parameters</h2>
<p>We see that the effect of dose on survival time has become more significant after we have incorporated weight in our model. This makes sense, because</p>
<ol style="list-style-type: decimal">
<li><p>From the data exploration, we learned that weight is associated with survival. As such, by incorporating weight in our model, we are able to explain a larger part of the variability in the response variable survival time. As a consequence, the variability in the residuals of the model will decrease, which in turn will lead to smaller standard error estimates for the different parameter estimates in the model.</p></li>
<li><p>From the data exploration, we additionally found that the (dojo-)fish weights are not perfectly uniform across the different poison dosages. Therefore, the pure effect between dose and survival time maay be somewhat disturbed by these (unwanted) fluctuations in weight, since we know fish weight also affects survival time. As such, we will be able to better estimate the pure effect between dose and survival if we <em>correct</em> the analysis for the effect of weight.</p></li>
</ol>
<p>In conclusion, we will be able to (1) estimate the dosage effect more precisely and (2) estimate the dosage effect with less bias wheen we add weight as an additional covariate to our model.</p>
<p>In this model, the effect of <code>Dose</code> can be interpreted as the average change in the log2 survival time betwn two groups of dojofish <strong>with the same weight</strong> that are exposed to a poison dosage that differs 1 mg/L. In symbols:</p>
<p><span class="math display">\[\begin{eqnarray}
\hat{\mu_1}&amp;=&amp; \beta_0 + \beta_d x_{1d} + \beta_g x_g \text{ (average log2-survival time for dose 1 for a certain weight)}\\
\hat{\mu_2}&amp;=&amp; \beta_0 + \beta_d x_{2d} + \beta_g x_g \text{ (average log2-survival time for dose 2 for that same weight)}\\
\hat \mu_2- \hat \mu_1&amp;=&amp;\beta_0 + \beta_d x_{2d} + \beta_g x_g - (\beta_0 + \beta_d x_{1d} + \beta_g x_g) \text{ (difference in average log2-survival time between dose 2 en dose 1)}\\ 
\hat \mu_2-\hat \mu_1&amp;=&amp;\beta_d (x_{2d}-x_{1d})
\end{eqnarray}\]</span></p>
<p>If the difference in poison concentration is <span class="math inline">\((x_{2d}-x_{1d})=1\)</span> mg/l, then we indeed observe that <span class="math inline">\(\hat \mu_2-\hat \mu_1=\beta_d\)</span>. <span class="math inline">\(\beta_d\)</span> thus quantifies the as average change in the log2 survival time betwn two groups of dojofish <strong>with the same weight</strong>.</p>
</div>
<div id="conclusion" class="section level2">
<h2><span class="header-section-number">7.5</span> Conclusion</h2>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="dv">2</span><span class="op">^</span>(lm_additive<span class="op">$</span>coef)</span></code></pre></div>
<pre><code>## (Intercept)        Dose      Weight 
##    1.777004    0.514402    2.111484</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="dv">2</span><span class="op">^</span>(<span class="kw">confint</span>(lm_additive))</span></code></pre></div>
<pre><code>##                 2.5 %    97.5 %
## (Intercept) 0.7169728 4.4042734
## Dose        0.3945101 0.6707292
## Weight      1.4259918 3.1265018</code></pre>
<p>The dose of the poison has an extremely significant effect on the survival time of dojofish (p-value = 1.17e-05). The geometric average of the survival time of dojofish is reduced (approximately halfed, factor = <span class="math inline">\(2^{\beta_d}=\)</span> 0.514) if the dose of poison is increased with 1 mg/L (95% BI [0.395,0.671]).</p>
<p>The effect of weight on the survival time of dojofish is also extremely significant (p-value = 0.000451). The geometric average of the survival time of a dojofish that weighs 1 gram extra compared to another dojofish is approximately twice as long (factor = <span class="math inline">\(2^{ \beta_g}\)</span>= 2.11, 95% BI [1.43,3.13]).</p>
</div>
<div id="remarks" class="section level2">
<h2><span class="header-section-number">7.6</span> Remarks</h2>
<p>In the <code>lm_additive</code> model, we included only a <em>main effect</em> for weight. However, there could also be an <em>interaction effect</em> between weight and dose. This potential interaction effect can be thought of as follows: the relationship between dose and survival time may be influenced by differences in fish weight. The weight main effect, on the other hand, only models the direct effect of fish weight on survival time.</p>
<p>Since we do not know in advance if the <em>interaction effect</em> is significant, we should always first include the interaction effect in our model. If this effect turns out to be insignificant, we may ommit the interaction term from the model to obtain aa <em>reduced</em> model (model selection).</p>
</div>
</div>
<div id="analysis-with-interaction-and-main-effect-for-weight" class="section level1">
<h1><span class="header-section-number">8</span> Analysis with interaction and main effect for weight</h1>
<div id="model-specification-1" class="section level2">
<h2><span class="header-section-number">8.1</span> Model specification</h2>
<p><span class="math display">\[
y_i=\beta_0+\beta_d x_d + \beta_g x_g +\beta_{d:g} x_d x_g+ \epsilon_i,
\]</span></p>
<p>with <span class="math inline">\(\epsilon_i \text{ i.i.d. } N(0,\sigma^2)\)</span></p>
</div>
<div id="assumptions-1" class="section level2">
<h2><span class="header-section-number">8.2</span> Assumptions</h2>
<p>The model will again be fit to allow for assessing the model assumptions</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="co"># lm_Int &lt;- lm(log2Surv_time ~ Dose+Weight+Dose:Weight, data = poison_dojo) # equivalent</span></span>
<span id="cb34-2"><a href="#cb34-2"></a>lm_Int &lt;-<span class="st"> </span><span class="kw">lm</span>(log2Surv_time <span class="op">~</span><span class="st"> </span>Dose<span class="op">*</span>Weight, <span class="dt">data =</span> poison_dojo) <span class="co"># * -&gt; short notation</span></span>
<span id="cb34-3"><a href="#cb34-3"></a></span>
<span id="cb34-4"><a href="#cb34-4"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb34-5"><a href="#cb34-5"></a><span class="kw">plot</span>(lm_Int)</span></code></pre></div>
<p><img src="08_x_poison1_sol_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>All assumption are <strong>met</strong>.</p>
</div>
<div id="inference-1" class="section level2">
<h2><span class="header-section-number">8.3</span> Inference</h2>
<p>We then inspect the results.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="kw">summary</span>(lm_Int)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log2Surv_time ~ Dose * Weight, data = poison_dojo)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.62807 -0.34662 -0.05587  0.30656  0.79086 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)  -0.2851     2.4062  -0.118    0.906
## Dose         -0.2217     1.5440  -0.144    0.887
## Weight        1.6061     1.1325   1.418    0.165
## Dose:Weight  -0.3485     0.7242  -0.481    0.633
## 
## Residual standard error: 0.416 on 35 degrees of freedom
## Multiple R-squared:  0.5173, Adjusted R-squared:  0.4759 
## F-statistic:  12.5 on 3 and 35 DF,  p-value: 1.036e-05</code></pre>
</div>
<div id="interpretation-of-model-parameters-1" class="section level2">
<h2><span class="header-section-number">8.4</span> Interpretation of model parameters</h2>
<p>We may interpret the estimate parameters as follows:</p>
<ul>
<li><p>For a fish with weight <span class="math inline">\(x_g\)</span>, the expected log2 survival time will be <span class="math inline">\(\beta_d+\beta_{d:g}*x_g\)</span> higher when the poison dose is increased with 1 mg/L, as compared to fish with the same weight.</p></li>
<li><p>For a wish that was exposed to dose <span class="math inline">\(x_g\)</span>, the expected log2 survival time will be <span class="math inline">\(\beta_d+\beta_{d:g}*x_g\)</span> higher for a fish with a weight that is 1 gram higher than that of another fish.</p></li>
</ul>
<p>The parameter <span class="math inline">\(\beta_{d:g}\)</span> can thus be interpreted in two ways. The easiest one is that the effect of dose on the log2 survival time is dependent on the weight of the fish. Alternatively, it can also be interpreted as the effect of weight on the log2 survival time being dependent on the dose that was administered.</p>
</div>
<div id="inference-2" class="section level2">
<h2><span class="header-section-number">8.5</span> Inference</h2>
<p>The effect of dose is now parameterized by two model parameters (<span class="math inline">\(\beta_d\)</span> and <span class="math inline">\(\beta_{d:g}\)</span>). We first evaluate an <em>omnibus</em> hypotheses that there is no effect of dose, i.e., no main effect nor an interaction effect. We can test this with aan F-test that compares a <em>full</em> model (1) containing a main effect for dose, a main effect for weight and an interaction between dose and weight with a model (2) that only contains a main effect for weight (i.e. no effect for dose).</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="co">#lmDojo_weight &lt;- lm(log2Surv_time ~ Dose*Weight, data = poison_dojo)</span></span>
<span id="cb37-2"><a href="#cb37-2"></a>lmDojo_weight &lt;-<span class="st"> </span><span class="kw">lm</span>(log2Surv_time <span class="op">~</span><span class="st"> </span>Weight, <span class="dt">data =</span> poison_dojo)</span>
<span id="cb37-3"><a href="#cb37-3"></a><span class="kw">anova</span>(lmDojo_weight, lm_Int)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Res.Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["RSS"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Sum of Sq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["F"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"37","2":"10.470626","3":"NA","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"35","2":"6.058125","3":"2","4":"4.412501","5":"12.74631","6":"6.940617e-05","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>We observe an extremely significant (overall, or global) effect for dose on the log2 survival time of dojofish (p-value = 6.94e-05.</p>
</div>
<div id="conventional-approach" class="section level2">
<h2><span class="header-section-number">8.6</span> Conventional approach</h2>
<p>We already estbalished that there is a significant overall effect of dose. Now, we will test if there is a significant interaction effect between dose and weight. Since we only have one interaction term in this model, this can be achieved in several ways:</p>
<ol style="list-style-type: decimal">
<li>The <code>summary</code> function</li>
<li>An F-test comparing models with and without the interaction effect</li>
<li>An ANOVA table with type III sum of squares</li>
</ol>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="kw">summary</span>(lm_Int) <span class="co">#1</span></span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log2Surv_time ~ Dose * Weight, data = poison_dojo)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.62807 -0.34662 -0.05587  0.30656  0.79086 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)  -0.2851     2.4062  -0.118    0.906
## Dose         -0.2217     1.5440  -0.144    0.887
## Weight        1.6061     1.1325   1.418    0.165
## Dose:Weight  -0.3485     0.7242  -0.481    0.633
## 
## Residual standard error: 0.416 on 35 degrees of freedom
## Multiple R-squared:  0.5173, Adjusted R-squared:  0.4759 
## F-statistic:  12.5 on 3 and 35 DF,  p-value: 1.036e-05</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="kw">anova</span>(lm_additive,lm_Int) <span class="co">#2</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Res.Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["RSS"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Sum of Sq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["F"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"36","2":"6.098213","3":"NA","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"35","2":"6.058125","3":"1","4":"0.04008759","5":"0.2316006","6":"0.6333347","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="kw">Anova</span>(lm_Int,<span class="dt">type=</span><span class="st">&quot;III&quot;</span>) <span class="co">#3</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Sum Sq"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["F value"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.002430229","2":"1","3":"0.01404032","4":"0.9063554","_rn_":"(Intercept)"},{"1":"0.003567063","2":"1","3":"0.02060822","4":"0.8866747","_rn_":"Dose"},{"1":"0.348114636","2":"1","3":"2.01118522","4":"0.1649862","_rn_":"Weight"},{"1":"0.040087588","2":"1","3":"0.23160062","4":"0.6333347","_rn_":"Dose:Weight"},{"1":"6.058125383","2":"35","3":"NA","4":"NA","_rn_":"Residuals"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>There is no significant interaction between dose and weight. As such, the effect of dose on survival is not signifiantly different between fish of different weight.</p>
<p>The conventional approach is to now remove the interaction effect from the model. As such, we are left with the additivee linear regression model <code>lm_additive</code> that we have alreaady fitted above.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="kw">summary</span>(lm_additive)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log2Surv_time ~ Dose + Weight, data = poison_dojo)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.59629 -0.33110 -0.06836  0.32507  0.83315 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   0.8294     0.6457   1.285 0.207119    
## Dose         -0.9590     0.1888  -5.081 1.17e-05 ***
## Weight        1.0783     0.2792   3.862 0.000451 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4116 on 36 degrees of freedom
## Multiple R-squared:  0.5141, Adjusted R-squared:  0.4871 
## F-statistic: 19.04 on 2 and 36 DF,  p-value: 2.282e-06</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="dv">2</span><span class="op">^</span>(lm_additive<span class="op">$</span>coef) <span class="co"># original scale</span></span></code></pre></div>
<pre><code>## (Intercept)        Dose      Weight 
##    1.777004    0.514402    2.111484</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="dv">2</span><span class="op">^</span>(<span class="kw">confint</span>(lm_additive))</span></code></pre></div>
<pre><code>##                 2.5 %    97.5 %
## (Intercept) 0.7169728 4.4042734
## Dose        0.3945101 0.6707292
## Weight      1.4259918 3.1265018</code></pre>
<div id="conclusion-1" class="section level3">
<h3><span class="header-section-number">8.6.1</span> Conclusion</h3>
<p>The conclusion is exactly the same as for the additive model analysis above (obviously, as we are dealing with the same model):</p>
<p>The dose of the poison has an extremely significant effect on the survival time of dojofish (p-value = 1.17e-05). The geometric average of the survival time of dojofish is reduced (approximately halfed, factor = <span class="math inline">\(2^{\beta_d}=\)</span> 0.514) if the dose of poison is increased with 1 mg/L (95% BI [0.395,0.671]).</p>
<p>The effect of dose on survival is not signifiantly different between fish of different weight. (p = 0.63).</p>
</div>
</div>
<div id="alternative-approach" class="section level2">
<h2><span class="header-section-number">8.7</span> Alternative approach</h2>
<p>Alternatively, we may perform an analysis without removing the interaction effect.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="kw">summary</span>(lm_Int)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log2Surv_time ~ Dose * Weight, data = poison_dojo)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.62807 -0.34662 -0.05587  0.30656  0.79086 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)  -0.2851     2.4062  -0.118    0.906
## Dose         -0.2217     1.5440  -0.144    0.887
## Weight        1.6061     1.1325   1.418    0.165
## Dose:Weight  -0.3485     0.7242  -0.481    0.633
## 
## Residual standard error: 0.416 on 35 degrees of freedom
## Multiple R-squared:  0.5173, Adjusted R-squared:  0.4759 
## F-statistic:  12.5 on 3 and 35 DF,  p-value: 1.036e-05</code></pre>
<p>The interaction effect is not significant, so we would accept the null hypothesis that there is no interaction effect. However, accepting a null hypothesis is a <strong>weak conlusion</strong>. In addition, we know that the <strong>power to</strong> <strong>find an interaction effect is low</strong>. As such, we may still want to include an interaction effect in the model (if we want to play safe).</p>
<p>With this model, we could still say something about the average dosis effect for the dojofish in this experiment. This would require us to <strong>marginalize</strong> accros all dojofish in the experiment, i.e.,</p>
<p><span class="math display">\[
\frac{\sum\limits_{i=1}^{n_\text{dojo}} (\beta_d + \beta_{d:w} x_{iw})}{n_\text{dojo}} = \beta_d + \beta_{d:w} \bar{x}_w
\]</span></p>
<p>In other words, we aree estimating the dose effect for <strong>“the average dojofish”</strong> in the experiment.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>wBar &lt;-<span class="st"> </span>poison <span class="op">%&gt;%</span></span>
<span id="cb50-2"><a href="#cb50-2"></a><span class="st">  </span><span class="kw">pull</span>(Weight) <span class="op">%&gt;%</span></span>
<span id="cb50-3"><a href="#cb50-3"></a><span class="st">  </span>mean</span>
<span id="cb50-4"><a href="#cb50-4"></a>wBar</span></code></pre></div>
<pre><code>## [1] 2.092847</code></pre>
<p>The average weigth for a dojofish in this experiment is 2.09 grams.</p>
<p>We now evaluate the contrast for the marginal dose effect, i.e., if <span class="math inline">\(\beta_d+2.1313*\beta_{d:g}\)</span> is significantly different from zero.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>marginalDosisEffect &lt;-<span class="st"> </span><span class="kw">glht</span>(lm_Int, <span class="dt">linfct =</span> <span class="kw">c</span>(<span class="st">&quot;Dose + 2.1313*Dose:Weight = 0&quot;</span>))</span>
<span id="cb52-2"><a href="#cb52-2"></a><span class="kw">summary</span>(marginalDosisEffect)</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Fit: lm(formula = log2Surv_time ~ Dose * Weight, data = poison_dojo)
## 
## Linear Hypotheses:
##                                  Estimate Std. Error t value Pr(&gt;|t|)    
## Dose + 2.1313 * Dose:Weight == 0  -0.9645     0.1911  -5.046  1.4e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="kw">confint</span>(marginalDosisEffect)</span></code></pre></div>
<pre><code>## 
##   Simultaneous Confidence Intervals
## 
## Fit: lm(formula = log2Surv_time ~ Dose * Weight, data = poison_dojo)
## 
## Quantile = 2.0301
## 95% family-wise confidence level
##  
## 
## Linear Hypotheses:
##                                  Estimate lwr     upr    
## Dose + 2.1313 * Dose:Weight == 0 -0.9645  -1.3525 -0.5764</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="dv">2</span><span class="op">^</span><span class="kw">confint</span>(marginalDosisEffect)<span class="op">$</span>confint</span></code></pre></div>
<pre><code>##                              Estimate       lwr       upr
## Dose + 2.1313 * Dose:Weight 0.5124711 0.3916119 0.6706299
## attr(,&quot;conf.level&quot;)
## [1] 0.95
## attr(,&quot;calpha&quot;)
## [1] 2.030108</code></pre>
<p><strong>! notice that the marginal dosis effect is almost exactly the same as the</strong> <strong>effect that was estimated for the model without the interaction effect!</strong></p>
<div id="conclusion-2" class="section level3">
<h3><span class="header-section-number">8.7.1</span> Conclusion</h3>
<p>We observe an extremely significant (overall, or global) effect for dose on the log2 survival time of dojofish (p-value = 6.94e-05.</p>
<p>The effect of dose on survival is not signifiantly different between fish of different weight. (p = 0.63).</p>
<p>The marginal geometric average of the log2 survival approximateely halves (factor = 0.512) for fish that are subjectd to a dose that is 1 mg/L higher (95% CI [0.392, 0.671]), after correction for weight (p-value = 1.4e-05.</p>
</div>
</div>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiRXhlcmNpc2UgOC54OiBBZGRpdGl2ZSBsaW5lYXIgbW9kZWwgb24gdGhlIHBvaXNvbiBkYXRhc2V0IC0gc29sdXRpb24iICAgCmF1dGhvcjogIkxpZXZlbiBDbGVtZW50IGFuZCBKZXJvZW4gR2lsaXMiCmRhdGU6ICJzdGF0T21pY3MsIEdoZW50IFVuaXZlcnNpdHkgKGh0dHBzOi8vc3RhdG9taWNzLmdpdGh1Yi5pbykiICAKb3V0cHV0OgogICAgaHRtbF9kb2N1bWVudDoKICAgICAgY29kZV9kb3dubG9hZDogdHJ1ZSAgICAKICAgICAgdGhlbWU6IGNvc21vCiAgICAgIHRvYzogdHJ1ZQogICAgICB0b2NfZmxvYXQ6IHRydWUKICAgICAgaGlnaGxpZ2h0OiB0YW5nbwogICAgICBudW1iZXJfc2VjdGlvbnM6IHRydWUKLS0tCgojIEZpc2ggdGFuayBkYXRhc2V0CgpJbiB0aGlzIGV4cGVyaW1lbnQsIDk2IGZpc2ggKGRvam9maXNoLCBnb2xkZmlzaCBhbmQgemVicmFmaXNoKQp3ZXJlIHBsYWNlZCBzZXBhcmF0ZWx5IGluIGEgdGFuayB3aXRoIHR3byBsaXRlcnMgb2Ygd2F0ZXIgYW5kCmEgY2VydGFpbiBkb3NlIChpbiBtZykgb2YgdGhlIHBvaXNvbiBFSS00MywwNjQuIFRoZSByZXNpc3RhbmNlCm9mIHRoZSBmaXNoIGFnYWluc3QgdGhlIHBvaXNvbiB3YXMgbWVhc3VyZWQgYXMgdGhlIGFtb3VudCBvZgptaW51dGVzIHRoZSBmaXNoIHN1cnZpdmVkIGFmdGVyIGJlaW5nIGV4cG9zZWQgdG8gdGhlIHBvaXNvbiAoYFN1cnZfdGltZWAsIGluCm1pbnV0ZXMpLiBBZGRpdGlvbmFsbHksIHRoZSB3ZWlnaHQgb2YgZWFjaCBmaXNoIHdhcyBtZWFzdXJlZC4KCiMgR29hbAoKVGhlIHJlc2VhcmNoIGdvYWwgaXMgdG8gc3R1ZHkgdGhlIGFzc29jaWF0aW9uIGJldHdlZW4gdGhlIGRvc2Ugb2YKdGhlIHBvaXNvbiB0aGF0IHdhcyBhZG1pbmlzdGVyZWQgdG8gdGhlIGZpc2ggYW5kIHRoZWlyIHN1cnZpdmFsIHRpbWUuCgpMb2FkIGxpYnJhcmllcwoKYGBge3IsIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0V9CmxpYnJhcnkodGlkeXZlcnNlKQpsaWJyYXJ5KGdncGxvdDIpCiNpbnN0YWxsLnBhY2thZ2VzKCJHR2FsbHkiKQpsaWJyYXJ5KEdHYWxseSkKbGlicmFyeShjYXIpCmxpYnJhcnkobXVsdGNvbXApCmBgYAoKIyBJbXBvcnQgdGhlIGRhdGEKCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQpwb2lzb24gPC0gcmVhZF9jc3YoImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9zdGF0T21pY3MvUFNMUzIxL2RhdGEvcG9pc29uLmNzdiIpCmBgYAoKIyBEYXRhIHRpZHlpbmcKCldlIGNhbiBzZWUgYSBjb3VwbGUgb2YgdGhpbmdzIGluIHRoZSBkYXRhIHRoYXQgY2FuIGJlIGltcHJvdmVkOgoKMS4gQ2FwaXRhbGlzZSB0aGUgZmlzdCBjb2x1bW4gbmFtZQoKMi4gU2V0IHRoZSBTcGVjaWVzIGNvbHVtbiBhcyBhIGZhY3RvcgoKMy4gQ2hhbmdlIHRoZSBzcGVjaWVzIGZhY3RvciBsZXZlbHMgZnJvbSAwLCAxIGFuZCAyIHRvCkRvam9maXNoLCBHb2xkZmlzaCBhbmQgWmVicmFmaXNoLiAqSGludCo6IHVzZSB0aGUgYGZjdF9yZWNvZGVgIGZ1bmN0aW9uLgoKNC4gSW4gcHJldmlvdXMgYW5hbHlzaXMgb24gdGhpcyBkYXRhc2V0IChgU2ltcGxlIGxpbmVhciByZWdyZXNzaW9uIHNlc3Npb25gKSwgd2UKcGVyZm9ybWVkIGEgbG9nLXRyYW5zZm9ybWF0aW9uIG9uIHRoZSByZXNwb25zZSB2YXJpYWJsZSBgU3Vydl90aW1lYCB0byBtZWV0IHRoZQpub3JtYWxpdHkgYW5kIGhvbW9zY2VkYXN0aWNpdHkgYXNzdW1wdGlvbnMgb2YgdGhlIGxpbmVhciBtb2RlbC4gSGVyZSwgd2Ugd2lsbAppbW1lZGlhdGVseSB3b3JrIHdpdGggbG9nLXRyYW5zZm9ybWVkIHN1cnZpdmFsIHRpbWVzOyBzdG9yZSB0aGVzZSBpbiB0aGUgbmV3IAp2YXJpYWJsZSBgbG9nMlN1cnZfdGltZWAgYW5kIHJlbW92ZSB0aGUgbm9uLXRyYW5zZm9ybWVkIHZhbHVlcy4KCmBgYHtyfQpwb2lzb24gPC0gcG9pc29uICU+JQogIHJlbmFtZSgiU3BlY2llcyIgPSAic3BlY2llcyIpICU+JQogIG11dGF0ZShTcGVjaWVzID0gYXMuZmFjdG9yKFNwZWNpZXMpKSAlPiUKICBtdXRhdGUoU3BlY2llcyA9IGZjdF9yZWNvZGUoU3BlY2llcywgRG9qb2Zpc2ggPSAiMCIsIEdvbGRmaXNoID0gIjEiLCBaZWJyYWZpc2ggPSAiMiIpKSAlPiUKICBtdXRhdGUobG9nMlN1cnZfdGltZSA9IGxvZzIoU3Vydl90aW1lKSkgJT4lCiAgZHBseXI6OnNlbGVjdCghU3Vydl90aW1lKQoKcG9pc29uCmBgYAoKIyBEYXRhIGV4cGxvcmF0aW9uIChleHRlbnNpdmUpCgpQcmlvciB0byB0aGUgYW5hbHlzaXMsIHdlIHNob3VsZCBleHBsb3JlIG91ciBkYXRhLiBXZSBoYXZlIGEgcmF0aGVyIGNvbXBsZXggCmRhdGFzZXQ6IGFzIGRpc2N1c3NlZCBpbiB0aGUgKipzZXNzaW9uIG9uIHNpbXBsZSBsaW5lYXIgcmVncmVzc2lvbiBzZXNzaW9uKiosIHdlCmNhbiBpbWFnaW5lIGhvdyB0aGUgKGxvZzIpIHN1cnZpdmFsIHRpbWUgb2YgdGhlIGZpc2ggbm90IG9ubHkgZGVwZW5kcyBvbiB0aGUKZG9zZSBvZiBwb2lzb24gdGhhdCB3YXMgYWRtaW5pc3RlcmVkLCBidXQgYWxzbyBvbiB0aGUgd2VpZ2h0IG9mIHRoZSBmaXNoIGFuZAp0aGUgZmlzaCBzcGVjaWVzLgoKVG8gc3RhcnQgb3VyIGRhdGEgZXhwbG9yYXRpb24sIHdlIHdpbGwgbWFrZSB1c2Ugb2YgdGhlIGBnZ3BhaXJzYCBmdW5jdGlvbiBvZiB0aGUKYEdHYWxseWAgUiBwYWNrYWdlLiBUaGlzIGZ1bmN0aW9uIHdpbGwgZ2VuZXJhdGUgYSB2aXN1YWxpemF0aW9uIGNvbnRhaW5pbmcKbXVsdGlwbGUgcGFuZWxzLCB3aGljaCBkaXNwbGF5ICgxKSB1bml2YXJpYXRlIHBsb3RzIG9mIHRoZSBkaWZmZXJlbnQgdmFyaWFibGVzCmluIG91ciBkYXRhc2V0LCAoMikgYml2YXJpYXRlIHBsb3RzIGFuZCAoMykgY29ycmVsYXRpb24gY29lZmZpY2llbnRzIGJldHdlZW4gCnRoZSBkaWZmZXJlbnQgdmFyaWFibGVzLgoKYGBge3IsIG1lc3NhZ2U9RkFMU0V9CnBvaXNvbiAlPiUKICBnZ3BhaXJzICsgdGhlbWVfYncoKQpgYGAKCkJhc2VkIG9uIHRoZXNlIHBsb3RzLCB3ZSBvYnNlcnZlIHRoYXQ6CgotIFRoZSBzdXJ2aXZhbCB0aW1lIHNlZW1zIHRvIGJlIGFzc29jaWF0ZWQgd2l0aCBkb3NlLCBmaXNoIHdlaWdodCBhbmQgc3BlY2llcy4KCi0gVGhlIGFzc29jaWF0aW9uIGJldHdlZW4gd2VpZ2h0IGFuZCBzdXJ2aXZhbCB0aW1lIGlzIHZlcnkgc3Ryb25nIGFuZCBwb3NpdGl2ZS4KCi0gU3BlY2llcyAyIChnb2xkIGZpc2gpIGFyZSBtb3JlIHJlc2lzdGFudCB0byB0aGUgcG9pc29uLgoKLSBUaGVyZSBpcyBhbiBhc3NvY2lhdGlvbiBiZXR3ZWVuIHdlaWdodCBhbmQgc3BlY2llcy4KCktub3dpbmcgdGhpcywgd2Ugbm93IG1ha2UgYWRkaXRpb25hbCByZWxldmFudCB2aXN1YWxpemF0aW9ucy4KCkZpcnN0LCBtYWtlIGEgc2NhdHRlcnBsb3QgdGhhdCBkaXNwbGF5cyB0aGUgYXNzb2NpYXRpb24gYmV0d2VlbiBwb2lzb24gZG9zZSBhbmQKbG9nMiBzdXJ2aXZhbCB0aW1lLiBUbyBjaGVjayBpZiB0aGlzIGFzc29jaWF0aW9uIGNvdWxkIGJlIGxpbmVhciwgd2UgZml0IGEKbGluZWFyIHJlZ3Jlc3Npb24gbGluZSBhbmQgYSBzbW9vdGggImxvZXNzIiBsaW5lIHRocm91Z2ggdGhlIGRhdGEgY2xvdWQuCgpgYGB7ciwgbWVzc2FnZT1GQUxTRX0KcG9pc29uICU+JQogIGdncGxvdChhZXMoeD1Eb3NlLHk9bG9nMlN1cnZfdGltZSkpICsKICBnZW9tX3BvaW50KCkgKyAKICBzdGF0X3Ntb290aChtZXRob2QgPSAibG9lc3MiKSArCiAgZ2VvbV9zbW9vdGgobWV0aG9kPSdsbScsY29sPSJibGFjayIpICsgCiAgeWxhYigiU3Vydml2YWwgdGltZSAobG9nMiBtaW4pIikgKwogIHhsYWIoIkRvc2UgKG1nKSIpICsKICB0aGVtZV9idygpCmBgYAoKVGhlIGxpbmVhciByZWdyZXNzaW9uIGxpbmUgKGJsYWNrKSBpcyBhIGdvb2QgYXBwcm94aW1hdGlvbiBvZiB0aGUgYmVzdCBmaXR0aW5nIApzbW9vdGggbGluZSAoYmx1ZSkgdGhyb3VnaCB0aGUgZGF0YS4gQmFzZWQgb24gdGhpcyBmaWd1cmUsIGl0IHNlZW1zIHJlYWxpc3RpYyB0bwpzdWdnZXN0IGEgbGluZWFyIHJlbGF0aW9uc2hpcCBiZXR3ZWVuIGRvc2UgYW5kIHN1cnZpdmFsLCB3aGVyZSBoaWdoZXIgZG9zZXMKaGF2ZSBsb3dlciAobG9nMikgc3Vydml2YWwgdGltZXMuCgpIb3dldmVyLCB0aGlzIHBsb3QgaXMgbWlzc2luZyB0aGUgZWZmZWN0IHRoYXQgdGhlIG90aGVyIGV4cGxhbmF0b3J5IHZhcmlhYmxlcywKZmlzaCB3ZWlnaHQgYW5kIHNwZWNpZXMsIG1heSBoYXZlIG9uIHRoZSByZWxhdGlvbnNoaXAgYmV0d2VlbiBkb3NlIGFuZCBzdXJ2aXZhbAp0aW1lLiBUbyBhc3Nlc3MgdGhlIGVmZmVjdCBvZiBzcGVjaWVzLCB3ZSBtYXkgY29sb3IgZWFjaCBkb3QgaW4gdGhlIGFib3ZlCnNjYXR0ZXJwbG90IGFjY29yZGluZyB0byBzcGVjaWVzLiBJbiBhZGRpdGlvbiwgd2UgbWF5IGZpdCBhIHNlcGFyYXRlIGxpbmVhciAKcmVncmVzc2lvbiBsaW5lIGZvciBlYWNoIHNwZWNpZXMuCgpgYGB7ciwgbWVzc2FnZT1GQUxTRX0KcG9pc29uICU+JQogIGdncGxvdChhZXMoeCA9IERvc2UsIHkgPSBsb2cyU3Vydl90aW1lLCBjb2w9U3BlY2llcykpICsKICBnZW9tX3BvaW50KHNpemU9MikgKwogIHNjYWxlX2NvbG9yX21hbnVhbCh2YWx1ZXMgPSBjKCJyZWQiLCAiZGFya2dvbGRlbnJvZCIsICJibGFjayIpKSArCiAgc3RhdF9zbW9vdGgobWV0aG9kID0gImxtIiwgc2UgPSBGQUxTRSkgKyAjIHNlID0gRkFMU0Ugb21pdHMgY29uZmlkZW5jZSAKICAjIGludGVydmFsIGFyb3VuZCByZWdyZXNzaW9uIGxpbmUgdG8gbWFrZSB0byBwbG90IGxlc3MgY2x1dHRlcmVkCiAgeWxhYigiU3Vydml2YWwgdGltZSAobG9nMiBtaW4pIikgKwogIHhsYWIoIkRvc2UgKG1nKSIpICsKICBnZ3RpdGxlKCJBc3NvY2lhdGlvbiBiZXR3ZWVuIGRvc2UgYW5kIHN1cnZpdmFsIHRpbWUgLSBwZXIgc3BlY2llcyIpICsKICB0aGVtZV9idygpCmBgYAoKV2UgaW5kZWVkIG9ic2VydmUgYSBzdHJvbmcgaW5mbHVlbmNlIG9mIHNwZWNpZXMgb24gdGhlIHN1cnZpdmFsIHRpbWUuIApDbGVhcmx5LCB6ZWJyYWZpc2ggaGF2ZSB0aGUgbG93ZXN0IHN1cnZpdmFsIHRpbWUsIHdoZXJlYXMgZ29sZGZpc2ggaGF2ZSB0aGUgCmhpZ2hlc3Qgc3Vydml2YWwgdGltZS4gSG93ZXZlciwgd2UgYWxzbyBzZWUgdGhhdCB0aGUgc2xvcGVzIG9mIHRoZSBkaWZmZXJlbnQKcmVncmVzc2lvbiBsaW5lcyBhcmUgdmVyeSBzaW1pbGFyIGJldHdlZW4gdGhlIGRpZmZlcmVudCBzcGVjaWVzLCBzdWdnZXN0aW5nIGEKbGltaXRlZCBpbnRlcmFjdGlvbiBvZiB0aGUgc3BlY2llcyBlZmZlY3QgYW5kIHRoZSByZWxhdGlvbnNoaXAgYmV0d2VlbiBkb3NlCmFuZCBzdXJ2aXZhbCB0aW1lICoqKHNlZSBsYXRlciB0aGVvcnkgc2Vzc2lvbiBvbiBpbnRlcmFjdGlvbnMpLioqCgpOZXh0LCB3ZSBtYWtlIGEgc2NhdHRlcnBsb3QgdG8gdmlzdWFsaXplIHRoZSByZWxhdGlvbnNoaXAgYmV0d2VlbiBmaXNoIHdlaWdodCAKYW5kIHN1cnZpdmFsIHRpbWUuIFdlIGFnYWluIGZpdCBhIHNtb290aCAibG9lc3MiIGN1cnZlIHRocm91Z2ggdGhlIGRhdGEgY2xvdWQuCldlZSBhZGRpdGlvbmFsbHkgY29sb3IgdGhlIG9ic2VydmF0aW9uIGFjY29yZGluZyB0byBzcGVjaWVzLgoKYGBge3IsIG1lc3NhZ2U9RkFMU0V9CnBvaXNvbiAlPiUKICBnZ3Bsb3QoYWVzKHggPSBXZWlnaHQsIHkgPSBsb2cyU3Vydl90aW1lLCBjb2wgPSBTcGVjaWVzKSkgKwogIGdlb21fcG9pbnQoKSArCiAgc2NhbGVfY29sb3JfbWFudWFsKHZhbHVlcyA9IGMoInJlZCIsICJkYXJrZ29sZGVucm9kIiwgImJsYWNrIikpICsKICBzdGF0X3Ntb290aChtZXRob2QgPSAibG9lc3MiLCBjb2w9ImJsdWUiKSArCiAgeWxhYigiU3Vydml2YWwgdGltZSAobG9nMiBtaW4pIikgKwogIHhsYWIoIldlaWdodCIpICsKICBnZ3RpdGxlKCJBc3NvY2lhdGlvbiBiZXR3ZWVuIHdlaWdodCBhbmQgc3Vydml2YWwgdGltZSIpICsKICB0aGVtZV9idygpCmBgYAoKV2Ugb2JzZXJ2ZSBhIGNsZWFyLCBwb3NpdGl2ZSByZWxhdGlvbnNoaXAgYmV0d2VlbiBmaXNoIHdlaWdodCBhbmQgc3Vydml2YWwgdGltZSwKd2l0aCBoZWF2aWVyIGZpc2ggbGl2aW5nIGxvbmdlciB0aGFuIGxpZ2h0ZXIgZmlzaC4gV2UgYWxzbyBvYnNlcnZlIHRoYXQgZmlzaCAKd2VpZ2h0IGlzIGFzc29jaWF0ZWQgd2l0aCBmaXNoIHNwZWNpZXMsIHdpdGggemVicmFmaXNoIGJlaW5nIHRoZSBsaWdodGVzdCBmaXNoLApvbiBhdmVyYWdlLiBXZWUgbWF5IHZpc3VhbGl6ZSB0aGlzIHJlbGF0aW9uc2hpcCBtb3JlIGNsZWFybHkgdXNpbmcgYm94cGxvdHMKCmBgYHtyfQpwb2lzb24gJT4lIAogIGdncGxvdChhZXMoeCA9IFNwZWNpZXMsIHkgPSBXZWlnaHQsIGNvbCA9IFNwZWNpZXMpKSArCiAgZ2VvbV9ib3hwbG90KG91dGxpZXIuc2hhcGUgPSBOQSkgKwogIGdlb21faml0dGVyKCkgKwogIHNjYWxlX2NvbG9yX21hbnVhbCh2YWx1ZXMgPSBjKCJyZWQiLCAiZGFya2dvbGRlbnJvZCIsICJibGFjayIpKSArCiAgeWxhYigiV2VpZ3RoIChnKSIpICsKICBnZ3RpdGxlKCJBc3NvY2lhdGlvbiBiZXR3ZWVuIHNwZWNpZXMgYW5kIHdlaWdodCIpICsKICB0aGVtZV9idygpCmBgYAoKTmV4dCwgd2UgbWFheSBhc3Nlc3MgdGhlIGFzc29jaWF0aW9uIGJldHdlZW4gc3BlY2llcyBhbmQgbG9nMiBzdXJ2aXZhbCB0aW1lIAp1c2luZyBib3hwbG90cy4KCmBgYHtyfQpwb2lzb24gJT4lIAogIGdncGxvdChhZXMoeCA9IFNwZWNpZXMsIHkgPSBsb2cyU3Vydl90aW1lLCBjb2wgPSBTcGVjaWVzKSkgKwogIGdlb21fYm94cGxvdChvdXRsaWVyLnNoYXBlID0gTkEpICsKICBnZW9tX2ppdHRlcigpICsKICBzY2FsZV9jb2xvcl9tYW51YWwodmFsdWVzID0gYygicmVkIiwgImRhcmtnb2xkZW5yb2QiLCAiYmxhY2siKSkgKwogIHlsYWIoIlN1cnZpdmFsIHRpbWUgKGxvZzIgbWluKSIpICsKICBnZ3RpdGxlKCJBc3NvY2lhdGlvbiBiZXR3ZWVuIHNwZWNpZXMgYW5kIHN1cnZpdmFsIHRpbWUiKSArCiAgdGhlbWVfYncoKQpgYGAKClRoZXJlIGlzIGEgY2xlYXIgYXNzb2NpYXRpb24gYmV0d2VlbiBzcGVjaWVzIGFuZCBsb2cyIHN1cnZpdmFsIHRpbWUuIEhvd2V2ZXIsCm5vdCB0aGF0IHRoZSByZWxhdGlvbnNoaXAgYmV0d2VlbiBzcGVjaWVzIGFuZCBzdXJ2aXZhbCB0aW1lIGlzICpjb25mb3VuZGVkKiAKd2l0aCB0aGUgZWZmZWN0IG9mIHdlaWdodCEKCkZpbmFsbHksIHRoZXJlIGlzIG9uZSBhZGRpdGlvbmFsLCBsZXNzIGV4cGVjdGVkIHJlbGF0aW9uc2hpcCBiZXR3ZWVuIHRoZQpkaWZmZXJlbnQgdmFyaWFibGVzIGluIHRoZSBkYXRhLiBXZSBtYWtlIGEgc2NhYXR0ZXJwbG90IGZvciBEb3NlIGFuZCB3ZWlnaHQuCgpgYGB7ciwgbWVzc2FnZT1GQUxTRX0KcG9pc29uICU+JQogIGdncGxvdChhZXMoeCA9IERvc2UsIHkgPSBXZWlnaHQpKSArCiAgZ2VvbV9wb2ludCgpICsKICBnZ3RpdGxlKCJBc3NvY2lhdGlvbiBiZXR3ZWVuIGRvc2UgYW5kIHdlaWdodCIpICsKICB0aGVtZV9idygpICsgCiAgc3RhdF9zdW1tYXJ5KAogICAgZ2VvbSA9ICJwb2ludCIsCiAgICBmdW4ueSA9ICJtZWFuIiwKICAgIGNvbCA9ICJibGFjayIsCiAgICBzaXplID0gNCwKICAgIHNoYXBlID0gMjQsCiAgICBmaWxsID0gInJlZCIpCmBgYAoKV2UgYWRkaXRpb25hbGx5IG9ic2VydmUgdGhhdCB0aGUgYXZlcmFnZSB3ZWlnaHQgb2YgdGhlIGZpc2ggbm90IHVuaWZvcm0gZm9yCnRoZSBkaWZmZXJlbnQgZG9zZSB0aGF0IHdlcmUgYWRtaW5pc3RlcmVkLiBUaGlzIGNhbiBiZSBleHBsYWluZWQgYnkgdGhlIGZhY3QKdGhhdCB0aGUgZXhwZXJpbWVudGFsIGRlc2lnbiB3YXMgbm90IGJhbGFuY2VkIHdpdGggcmVzcGVjdCB0byBzcGVjaWVzIGFuZCBkb3NlLgpNb3JlIHNwZWNpZmljYWxseSwgZWFjaCBkb3NlIHdhcyBhZG1pbmlzdGVyZWQgdG8gOCBmaXNoLAoKYGBge3J9CmNvbFN1bXModGFibGUocG9pc29uJFNwZWNpZXMsIHBvaXNvbiREb3NlKSkKYGBgCgpob3dldmVyLCB0aGUgZGlzdHJpYnV0aW9uIG9mIHNwZWNpZXMgYWNyb3NzIHRoZSBkaWZmZXJlbnQgZG9zZXMgaXMgdmFyaWFibGUuICAgCgpgYGB7cn0KdGFibGUocG9pc29uJFNwZWNpZXMsIHBvaXNvbiREb3NlKQpgYGAKCkhvd2V2ZXIsIGV2ZW4gaWYgd2Ugd291bGQgc3Vic2V0IHRoZSBkYXRhIHRvIGUuZy4gY29udGFpbiBvbmx5IGRvam9maXNoLAp0aGUgZmlzaCB3ZWlnaHRzIGFyZSBzdGlsbCBub3QgbmljZWx5IHVuaWZvcm0gYWNjcm9zIHRoZSBkaWZmZXJlbnQgcG9pc29uCmRvc2FnZXMgKGR1ZSB0byByYW5kb20gZmx1Y3Rpb25zKS4KCmBgYHtyLCBtZXNzYWdlPUZBTFNFfQpwb2lzb24gJT4lCiAgZmlsdGVyKFNwZWNpZXMgPT0gIkRvam9maXNoIikgJT4lCiAgZ2dwbG90KGFlcyh4ID0gRG9zZSwgeSA9IFdlaWdodCkpICsKICBnZW9tX3BvaW50KCkgKwogIGdndGl0bGUoIkFzc29jaWF0aW9uIGJldHdlZW4gZG9zZSBhbmQgd2VpZ2h0IikgKwogIHRoZW1lX2J3KCkgKyAKICBzdGF0X3N1bW1hcnkoCiAgICBnZW9tID0gInBvaW50IiwKICAgIGZ1bi55ID0gIm1lYW4iLAogICAgY29sID0gImJsYWNrIiwKICAgIHNpemUgPSA0LAogICAgc2hhcGUgPSAyNCwKICAgIGZpbGwgPSAicmVkIikKYGBgCgpJbiBjb25jbHVzaW9uLCB3ZSBzZWUgdGhhdCBhbGwgdGhyZWUgZXhwbGFuYXRvcnkgdmFyaWFibGVzIChkb3NlLCBzcGVjaWVzIGFuZCAKd2VpZ2h0KSBzZWVtIHRvIGhhdmUgYW4gZWZmZWN0IG9uIHRoZSBsb2cyIHN1cnZpdmFsIHRpbWUuIEluIGFkZGl0aW9uLCB0aGVzZQpleHBsYW5hdG9yeSB2YXJpYWJsZSBvciBhbHNvIG5vdCBpbmRlcGVuZGVudC4gQXMgc3VjaCwgd2Ugc2hvdWxkIHRyeSB0byBjb21lIHVwCndpdGggYSBtb2RlbCB0aGF0IGFjY29tb2RhdGVzIHRoZXNlIGRpZmZlcmVudCBlZmZlY3RzLgoKSWRlYWxseSwgd2Ugc2hvdWxkIGNvbnN0cnVjdCBhIG1vZGVsIHRoYXQgYWNjb3VudHMgZm9yIGFsbCB0aGUgZGlmZmVyZW50CmFzc29jaWF0aW9ucyBvYnNlcnZlZCBpbiB0aGUgZGF0YSBleHBsb3JhdGlvbi4gU3VjaCBtb2RlbCBzaG91bGQKCi0gbW9kZWwgdGhlIGFzc29jaWF0aW9uIGJldHdlZW4gYERvc2VgIGFuZCBgbG9nMiBzdXJ2aXZhbCB0aW1lYCwgd2hpbGUKCi0gYWNjb3VudGluZyBmb3IgdGhlIGBzcGVjaWVzYCBlZmZlY3QsCgotIGFjY291bnRpbmcgZm9yIHRoZSBgd2VpZ2h0YCBlZmZlY3QsCgotIGFjY291bnRpbmcgZm9yIHRoZSBmYWN0IHRoYXQgdGhlIGFzc29jaWF0aW9uIGJldHdlZW4gYERvc2VgIGFuZCAKYGxvZzIgc3Vydml2YWwgdGltZWAgbWF5IGJlIGRpZmZlcmVudCBmb3IgZGlmZmVyZW50IGBzcGVjaWVzYC4KCi0gYW5kIGFjY291bnRpbmcgZm9yIHRoZSBmYWN0IHRoYXQgdGhlIGFzc29jaWF0aW9uIGJldHdlZW4gYERvc2VgIGFuZCAKYGxvZzIgc3Vydml2YWwgdGltZWAgbWF5IGJlIGRpZmZlcmVudCBmb3IgZmlzaCBvZiBkaWZmZXJlbnQgYHdlaWdodGAuCgoqKkJ5IHRoZSB0aW1lIG9mIHRoZSBsYXN0IGV4ZXJjaXNlIHNlc3Npb24gaW4gdGhpcyBzZXJpZXMsIHdlIHdpbGwgbGVhcm4gaG93KioKKip0byBjb25zdHJ1Y3Qgc3VjaCBhIG1vZGVsLiBGb3Igbm93LCB3ZSB3aWxsIHNpbXBsaWZ5IHRoZSByZXNlYXJjaCBxdWVzdGlvbioqCioqYnkgcmVkdWNpbmcgdGhlIGRhdGFzZXQgdG8gY29udGFpbiBvbmx5IGEgc2luZ2xlIGZpc2ggc3BlY2llcywgdGhlKioKKipkb2pvZmlzaCwgaS5lLjoqKgoKYGBge3J9CnBvaXNvbl9kb2pvIDwtIHBvaXNvbiAlPiUKICAgIGZpbHRlcihTcGVjaWVzID09ICJEb2pvZmlzaCIpCmBgYAoKKipGb3IgZGVtb25zdHJhdGlvbmFsIHB1cnBvc2VzLCB3ZSB3aWxsIGFuYWx5c2UgdGhpcyByZWR1Y2VkIGRhdGFzZXQgd2l0aCoqCioqdGhyZWUgZGlmZmVyZW50IHN0cmF0ZWdpZXMgd2l0aCBpbmNyZWFzaW5nIGNvbXBsZXhpdHk6KioKCioqMS4gYSBzaW1wbGUgbGluZWFyIHJlZ3Jlc3Npb24gbW9kZWwgKGluc3VmZmljaWVudCkqKgoqKjIuIGFuIGFkZGl0aXZlIGxpbmVhciByZWdyZXNzaW9uIG1vZGVsIChpbnN1ZmZpY2llbnQpKioKKiozLiBhIGxpbmVhciByZWdyZXNzaW9uIG1vZGVsIHdpdGggaW50ZXJhY3Rpb24qKgoKIyBTaW1wbGUgbGluZWFyIHJlZ3Jlc3Npb24gKGluc3VmZmljaWVudCkKClRoaXMgaXMgdGhlIHNhbWUgcmVncmVzc2lvbiBtb2RlbCB0aGF0IHdlIGhhdmUgYWxyZWFkeSBmaXQgaW4gdGhlIGV4ZXJjaXNlIApzZXNzaW9uIG9uIHNpbXBsZSBsaW5lYXIgcmVncmVzc2lvbiwgd2l0aCBgRG9zZWAgYXMgdGhlIG9ubHkgZXhwbGFuYXRvcnkgCnZhcmlhYmxlIGZvciBgbG9nMlN1cnZfdGltZWAuCgpgYGB7cn0KIyBmaXQgYSBsaW5lYXIgcmVncmVzc2lvbiBtb2RlbCB3aXRoICdTdXJ2X3RpbWUnIGFzIHJlc3BvbnNlIHZhcmlhYmxlIGFuZAojICdEb3NlJyBhcyBwcmVkaWN0b3IgdmFyaWFiZWxlCmxtX3NpbXBsZSA8LSBsbShsb2cyU3Vydl90aW1lIH4gRG9zZSwgZGF0YT1wb2lzb25fZG9qbykgCgojIyBkaXNwbGF5IHRoZSBkaWFnbm9zdGljIHBsb3RzIG9mIHRoZSBtb2RlbApwYXIobWZyb3c9YygyLDIpKQpwbG90KGxtX3NpbXBsZSkKYGBgCgoxLiBUaGUgaW5kZXBlbmRlbmNlIGFzc3VtcHRpb24gbm90IG1ldCwgZ2l2ZW4gdGhhdCB3ZSBleHBlY3QgdGhhdCBmaXNoIG9mCnNpbWlsYXIgd2VpZ2h0IHdpbGwgaGF2ZSBhIHNpbWlsYXIgYXNzb2NpYXRpb24gYmV0d2VlbiBkb3NlIGFuZCBzdXJ2aXZhbCB0aW1lLgoqKkZvciBub3csIHdlIHdpbGwgaWdub3JlIHRoaXMgcHJvYmxlbS4qKgoyLiBUaGUgbGluZWFyaXR5IGFzc3VtcHRpb24gaXMgKiptZXQqKi4KMy4gVGhlIG5vcm1hbGl0eSBhc3N1bXB0aW9uIGlzICoqbWV0KiouCjQuIFRoZSBob21vc2NlZGFzdGljaXR5IGFzc3VtcHRpb24gaXMgKiptZXQqKi4KCkZpbmFsbHksIHdlIGxvb2sgYXQgdGhlIG91dHB1dCBvZiB0aGUgbW9kZWwuCgpgYGB7cn0Kc3VtbWFyeShsbV9zaW1wbGUpCmBgYAoKT3IgZm9yIGFuIGludGVycHJldGF0aW9uIGF0IHRoZSBvcmlnaW5hbCBzY2FsZSAobWludXRlcyBpbiBzdGVhZCBvZiBsb2cyIAptaW51dGVzKToKCmBgYHtyfQoyXihsbV9zaW1wbGUkY29lZilbIkRvc2UiXQoyXihjb25maW50KGxtX3NpbXBsZSkpWzIsMV0KYGBgCgpUaGVyZSBpcyBhbiBleHRyZW1lbHkgc2lnbmlmaWNhbnQgZWZmZWN0IG9mIHRoZSBwb2lzb24gZG9zZSBvbiB0aGUgCmxvZzItdHJhbnNmb3JtZWQgc3Vydml2YWwgdGltZSBvZiBkb2pvZmlzaCAKKHAtdmFsdWUgPSBgciBmb3JtYXQoc3VtbWFyeShsbV9zaW1wbGUpJGNvZWZmaWNpZW50c1syLDRdLGRpZ2l0cz0zKWApLiBGb3IgZWFjaApleHRyYSBtaWxsaWdyYW0gb2YgcG9pc29uIGFkbWluaXN0ZXJlZCwgdGhlIGdlb21ldHJpYyBtZWFuIG9mIHN1cnZpdmFsIHRpbWUgd2lsbApkZWNyZWFzZSBieSBhIGZhY3RvciBvZiBgciBmb3JtYXQodW5uYW1lKDJeKGxtX3NpbXBsZSRjb2VmKVsiRG9zZSJdKSwgZGlnaXRzPTMpYCwKKDk1JSBDSSBbYHIgZm9ybWF0KHVubmFtZSgyXihjb25maW50KGxtX3NpbXBsZSkpWzIsMV0pLCBkaWdpdHM9MylgLApgciBmb3JtYXQodW5uYW1lKDJeKGNvbmZpbnQobG1fc2ltcGxlKSlbMiwyXSksIGRpZ2l0cz0zKWBdKS4KCkhvd2V2ZXIsIHdlIGtub3cgd2UgaGF2ZSB0byBiZSB2ZXJ5IGNhcmVmdWwgd2l0aCB0aGVzZSByZXN1bHRzLCBzaW5jZSB3ZSBkaWQgbm90IAppbmNsdWRlIHdlaWdodCBhcyBhIGNvdmFyaWF0ZSB0byBvdXIgbW9kZWwhCgojIEFuYWx5c2lzIHdpdGggYWRkaXRpdmUgZWZmZWN0IGZvciB3ZWlnaHQKCiMjIE1vZGVsIHNwZWNpZmljYXRpb24KCkluIGEgZmlzdCBhdHRlbXB0IHRvIGFjY291bnQgZm9yIHRoZSBlZmZlY3Qgb2YgYHdlaWdodGAsIHdlIG1heSBhZGQgdGhlIGB3ZWlnaHRgCnZhcmlhYmxlIGFzIGFuIGFkZGl0aW9uYWwgY292YXJpYXRlIHRvIG91ciBsaW5lYXIgcmVncmVzc2lvbiBtb2RlbCwgc3VjaCB0aGF0CgokJAp5X2k9XGJldGFfMCtcYmV0YV9kIHhfZCArIFxiZXRhX2cgeF9nICsgXGVwc2lsb25faSwKJCQKCndpdGggJFxlcHNpbG9uX2kgXHRleHR7IGkuaS5kLiB9IE4oMCxcc2lnbWFeMikkLgoKIyMgQXNzdW1wdGlvbnMKClRoZSBtb2RlbCB3aWxsIGFnYWluIGJlIGZpdCB0byBhbGxvdyBmb3IgYXNzZXNzaW5nIHRoZSBtb2RlbCBhc3N1bXB0aW9ucwoKYGBge3J9CmxtX2FkZGl0aXZlIDwtIGxtKGxvZzJTdXJ2X3RpbWUgfiBEb3NlICsgV2VpZ2h0LCBkYXRhID0gcG9pc29uX2Rvam8pCgpwYXIobWZyb3c9YygyLDIpKQpwbG90KGxtX2FkZGl0aXZlKQpgYGAKClRoZSBhc3N1bXB0aW9uIG9mIGluZGVwZW5kZW5jZSAoISksIGxpbmVhcml0eSBhbmQgaG9tb3NjZWRhc3RpY2l0eSBhcmUgbWV0LgoKQXJndWFibHksIHRoZXJlIG1pZ2h0IGJlIHNvbWUgZGV2aWF0aW9uIGZyb20gbm9ybWFsaXR5IGluIHRoZSBsZWZ0IHRhaWwgb2YgdGhlCmRpc3RyaWJ1dGlvbi4gSG93ZXZlciwgd2hlbiB3ZSB3b3VsZCBzaW11bGF0ZSBkYXRhIHVuZGVyIHRoZSBub3JtYWxpdHkKYXNzdW1wdGlvbiwgaXQgc2VlbXMgdGhhdCBkZXZpYXRpb25zIG9mIHRoaXMgc2l6ZSBtYXkgYmUgZXhwZWN0ZWQgd2hlbgpub3JtYWxpdHkgaXMgbWV0OgoKYGBge3J9CnNldC5zZWVkKDE0MDYpCm5vYnMgPC0gbnJvdyhwb2lzb25fZG9qbykKCmRhdGEuZnJhbWUoCiAgeSA9IGMobG1fYWRkaXRpdmUkcmVzLAogICAgICAgIHJub3JtKG5vYnMqOCwKICAgICAgICAgICAgICBzZCA9IHNpZ21hKGxtX2FkZGl0aXZlKQogICAgICAgICAgICAgKQogICAgICApLAogIGxhYmVsID0gcmVwKAogICAgICAgICAgICAgIGMoIm9yaWdpbmFsIGRhdGEiLAogICAgICAgICAgICAgICAgcGFzdGUwKCJzaW11bGF0aW9uICIsMTo4KSksCiAgICAgICAgICAgICAgZWFjaCA9IG5vYnMpKSAlPiUKICBnZ3Bsb3QoYWVzKHNhbXBsZSA9IHkpKSArCiAgZ2VvbV9xcSgpICsKICBnZW9tX3FxX2xpbmUoKSArCiAgZmFjZXRfd3JhcCh+IGxhYmVsKSArCiAgdGhlbWVfYncoKQpgYGAKCkFzIHN1Y2gsIGFsbCBhc3N1bXB0aW9ucyBmb3IgbGluZWFyIHJlZ3Jlc3Npb24gYXJlIG1ldC4KCiMjIEluZmVyZW5jZQoKV2UgdGhlbiBpbnNwZWN0IHRoZSByZXN1bHRzLgoKYGBge3J9CnN1bW1hcnkobG1fYWRkaXRpdmUpCmBgYAoKIyMgSW50ZXJwcmV0YXRpb24gb2YgbW9kZWwgcGFyYW1ldGVycwoKV2Ugc2VlIHRoYXQgdGhlIGVmZmVjdCBvZiBkb3NlIG9uIHN1cnZpdmFsIHRpbWUgaGFzIGJlY29tZSBtb3JlIHNpZ25pZmljYW50IAphZnRlciB3ZSBoYXZlIGluY29ycG9yYXRlZCB3ZWlnaHQgaW4gb3VyIG1vZGVsLiBUaGlzIG1ha2VzIHNlbnNlLCBiZWNhdXNlCgoxLiBGcm9tIHRoZSBkYXRhIGV4cGxvcmF0aW9uLCB3ZSBsZWFybmVkIHRoYXQgd2VpZ2h0IGlzIGFzc29jaWF0ZWQgd2l0aCAKc3Vydml2YWwuIEFzIHN1Y2gsIGJ5IGluY29ycG9yYXRpbmcgd2VpZ2h0IGluIG91ciBtb2RlbCwgd2UgYXJlIGFibGUgdG8KZXhwbGFpbiBhIGxhcmdlciBwYXJ0IG9mIHRoZSB2YXJpYWJpbGl0eSBpbiB0aGUgcmVzcG9uc2UgdmFyaWFibGUgc3Vydml2YWwgdGltZS4KQXMgYSBjb25zZXF1ZW5jZSwgdGhlIHZhcmlhYmlsaXR5IGluIHRoZSByZXNpZHVhbHMgb2YgdGhlIG1vZGVsIHdpbGwgZGVjcmVhc2UsCndoaWNoIGluIHR1cm4gd2lsbCBsZWFkIHRvIHNtYWxsZXIgc3RhbmRhcmQgZXJyb3IgZXN0aW1hdGVzIGZvciB0aGUgZGlmZmVyZW50CnBhcmFtZXRlciBlc3RpbWF0ZXMgaW4gdGhlIG1vZGVsLgoKMi4gRnJvbSB0aGUgZGF0YSBleHBsb3JhdGlvbiwgd2UgYWRkaXRpb25hbGx5IGZvdW5kIHRoYXQgdGhlIChkb2pvLSlmaXNoIHdlaWdodHMKYXJlIG5vdCBwZXJmZWN0bHkgdW5pZm9ybSBhY3Jvc3MgdGhlIGRpZmZlcmVudCBwb2lzb24gZG9zYWdlcy4gVGhlcmVmb3JlLCB0aGUgCnB1cmUgZWZmZWN0IGJldHdlZW4gZG9zZSBhbmQgc3Vydml2YWwgdGltZSBtYWF5IGJlIHNvbWV3aGF0IGRpc3R1cmJlZCBieSB0aGVzZSAKKHVud2FudGVkKSBmbHVjdHVhdGlvbnMgaW4gd2VpZ2h0LCBzaW5jZSB3ZSBrbm93IGZpc2ggd2VpZ2h0IGFsc28gYWZmZWN0cwpzdXJ2aXZhbCB0aW1lLiBBcyBzdWNoLCB3ZSB3aWxsIGJlIGFibGUgdG8gYmV0dGVyIGVzdGltYXRlIHRoZSBwdXJlIGVmZmVjdApiZXR3ZWVuIGRvc2UgYW5kIHN1cnZpdmFsIGlmIHdlICpjb3JyZWN0KiB0aGUgYW5hbHlzaXMgZm9yIHRoZSBlZmZlY3Qgb2Ygd2VpZ2h0LgoKSW4gY29uY2x1c2lvbiwgd2Ugd2lsbCBiZSBhYmxlIHRvICgxKSBlc3RpbWF0ZSB0aGUgZG9zYWdlIGVmZmVjdCBtb3JlIHByZWNpc2VseSAKYW5kICgyKSBlc3RpbWF0ZSB0aGUgZG9zYWdlIGVmZmVjdCB3aXRoIGxlc3MgYmlhcyB3aGVlbiB3ZSBhZGQgd2VpZ2h0IGFzIGFuCmFkZGl0aW9uYWwgY292YXJpYXRlIHRvIG91ciBtb2RlbC4KCkluIHRoaXMgbW9kZWwsIHRoZSBlZmZlY3Qgb2YgYERvc2VgIGNhbiBiZSBpbnRlcnByZXRlZCBhcyB0aGUgYXZlcmFnZSBjaGFuZ2UgaW4KdGhlIGxvZzIgc3Vydml2YWwgdGltZSBiZXR3biB0d28gZ3JvdXBzIG9mIGRvam9maXNoICoqd2l0aCB0aGUgc2FtZSB3ZWlnaHQqKiAKdGhhdCBhcmUgZXhwb3NlZCB0byBhIHBvaXNvbiBkb3NhZ2UgdGhhdCBkaWZmZXJzIDEgbWcvTC4gSW4gc3ltYm9sczoKClxiZWdpbntlcW5hcnJheX0KXGhhdHtcbXVfMX0mPSYgXGJldGFfMCArIFxiZXRhX2QgeF97MWR9ICsgXGJldGFfZyB4X2cgXHRleHR7IChhdmVyYWdlIGxvZzItc3Vydml2YWwgdGltZSBmb3IgZG9zZSAxIGZvciBhIGNlcnRhaW4gd2VpZ2h0KX1cXApcaGF0e1xtdV8yfSY9JiBcYmV0YV8wICsgXGJldGFfZCB4X3syZH0gKyBcYmV0YV9nIHhfZyBcdGV4dHsgKGF2ZXJhZ2UgbG9nMi1zdXJ2aXZhbCB0aW1lIGZvciBkb3NlIDIgZm9yIHRoYXQgc2FtZSB3ZWlnaHQpfVxcClxoYXQgXG11XzItIFxoYXQgXG11XzEmPSZcYmV0YV8wICsgXGJldGFfZCB4X3syZH0gKyBcYmV0YV9nIHhfZyAtIChcYmV0YV8wICsgXGJldGFfZCB4X3sxZH0gKyBcYmV0YV9nIHhfZykgXHRleHR7IChkaWZmZXJlbmNlIGluIGF2ZXJhZ2UgbG9nMi1zdXJ2aXZhbCB0aW1lIGJldHdlZW4gZG9zZSAyIGVuIGRvc2UgMSl9XFwgClxoYXQgXG11XzItXGhhdCBcbXVfMSY9JlxiZXRhX2QgKHhfezJkfS14X3sxZH0pClxlbmR7ZXFuYXJyYXl9CgpJZiB0aGUgZGlmZmVyZW5jZSBpbiBwb2lzb24gY29uY2VudHJhdGlvbiBpcyAkKHhfezJkfS14X3sxZH0pPTEkIG1nL2wsCnRoZW4gd2UgaW5kZWVkIG9ic2VydmUgdGhhdCAkXGhhdCBcbXVfMi1caGF0IFxtdV8xPVxiZXRhX2QkLiAkXGJldGFfZCQgdGh1cwpxdWFudGlmaWVzIHRoZSBhcyBhdmVyYWdlIGNoYW5nZSBpbiB0aGUgbG9nMiBzdXJ2aXZhbCB0aW1lIGJldHduIHR3byBncm91cHMgb2YgCmRvam9maXNoICoqd2l0aCB0aGUgc2FtZSB3ZWlnaHQqKi4KCiMjIENvbmNsdXNpb24KCmBgYHtyfQoyXihsbV9hZGRpdGl2ZSRjb2VmKQoyXihjb25maW50KGxtX2FkZGl0aXZlKSkKYGBgCgpUaGUgZG9zZSBvZiB0aGUgcG9pc29uIGhhcyBhbiBleHRyZW1lbHkgc2lnbmlmaWNhbnQgZWZmZWN0IG9uIHRoZSBzdXJ2aXZhbCB0aW1lCm9mIGRvam9maXNoIAoocC12YWx1ZSA9IGByIGZvcm1hdChzdW1tYXJ5KGxtX2FkZGl0aXZlKSRjb2VmZmljaWVudHNbMiw0XSxkaWdpdHM9MylgKS4gVGhlCmdlb21ldHJpYyBhdmVyYWdlIG9mIHRoZSBzdXJ2aXZhbCB0aW1lIG9mIGRvam9maXNoIGlzIHJlZHVjZWQgKGFwcHJveGltYXRlbHkKaGFsZmVkLCAKZmFjdG9yID0gJDJee1xiZXRhX2R9PSQgYHIgZm9ybWF0KDJeKGxtX2FkZGl0aXZlJGNvZWZbIkRvc2UiXSksZGlnaXRzPTMpYCkgaWYKdGhlIGRvc2Ugb2YgcG9pc29uIGlzIGluY3JlYXNlZCB3aXRoIDEgbWcvTCAKKDk1JSBCSSBbYHIgcGFzdGUoZm9ybWF0KDJeKGNvbmZpbnQobG1fYWRkaXRpdmUpWyJEb3NlIixdKSxkaWdpdHM9MyksY29sbGFwc2U9IiwiKWBdKS4KClRoZSBlZmZlY3Qgb2Ygd2VpZ2h0IG9uIHRoZSBzdXJ2aXZhbCB0aW1lIG9mIGRvam9maXNoIGlzIGFsc28gZXh0cmVtZWx5IApzaWduaWZpY2FudCAKKHAtdmFsdWUgPSBgciBmb3JtYXQoc3VtbWFyeShsbV9hZGRpdGl2ZSkkY29lZmZpY2llbnRzWzMsNF0sZGlnaXRzPTMpYCkuIFRoZQpnZW9tZXRyaWMgYXZlcmFnZSBvZiB0aGUgc3Vydml2YWwgdGltZSBvZiBhIGRvam9maXNoIHRoYXQgd2VpZ2hzIDEgZ3JhbSBleHRyYQpjb21wYXJlZCB0byBhbm90aGVyIGRvam9maXNoIGlzIGFwcHJveGltYXRlbHkgdHdpY2UgYXMgbG9uZyAKKGZhY3RvciA9ICQyXnsgXGJldGFfZ30kPSBgciBmb3JtYXQoMl4obG1fYWRkaXRpdmUkY29lZlsiV2VpZ2h0Il0pLGRpZ2l0cz0zKWAsIAo5NSUgQkkgW2ByIHBhc3RlKGZvcm1hdCgyXihjb25maW50KGxtX2FkZGl0aXZlKVsiV2VpZ2h0IixdKSxkaWdpdHM9MyksY29sbGFwc2U9IiwiKWBdKS4KCiMjIFJlbWFya3MKCkluIHRoZSBgbG1fYWRkaXRpdmVgIG1vZGVsLCB3ZSBpbmNsdWRlZCBvbmx5IGEgKm1haW4gZWZmZWN0KiBmb3Igd2VpZ2h0LiAKSG93ZXZlciwgdGhlcmUgY291bGQgYWxzbyBiZSBhbiAqaW50ZXJhY3Rpb24gZWZmZWN0KiBiZXR3ZWVuIHdlaWdodCBhbmQKZG9zZS4gVGhpcyBwb3RlbnRpYWwgaW50ZXJhY3Rpb24gZWZmZWN0IGNhbiBiZSB0aG91Z2h0IG9mIGFzIGZvbGxvd3M6CnRoZSByZWxhdGlvbnNoaXAgYmV0d2VlbiBkb3NlIGFuZCBzdXJ2aXZhbCB0aW1lIG1heSBiZSBpbmZsdWVuY2VkIGJ5IGRpZmZlcmVuY2VzCmluIGZpc2ggd2VpZ2h0LiBUaGUgd2VpZ2h0IG1haW4gZWZmZWN0LCBvbiB0aGUgb3RoZXIgaGFuZCwgb25seSBtb2RlbHMgdGhlIApkaXJlY3QgZWZmZWN0IG9mIGZpc2ggd2VpZ2h0IG9uIHN1cnZpdmFsIHRpbWUuCgpTaW5jZSB3ZSBkbyBub3Qga25vdyBpbiBhZHZhbmNlIGlmIHRoZSAqaW50ZXJhY3Rpb24gZWZmZWN0KiBpcyBzaWduaWZpY2FudCwgCndlIHNob3VsZCBhbHdheXMgZmlyc3QgaW5jbHVkZSB0aGUgaW50ZXJhY3Rpb24gZWZmZWN0IGluIG91ciBtb2RlbC4gSWYgdGhpcyAKZWZmZWN0IHR1cm5zIG91dCB0byBiZSBpbnNpZ25pZmljYW50LCB3ZSBtYXkgb21taXQgdGhlIGludGVyYWN0aW9uIHRlcm0gZnJvbSAKdGhlIG1vZGVsIHRvIG9idGFpbiBhYSAqcmVkdWNlZCogbW9kZWwgKG1vZGVsIHNlbGVjdGlvbikuCgojIEFuYWx5c2lzIHdpdGggaW50ZXJhY3Rpb24gYW5kIG1haW4gZWZmZWN0IGZvciB3ZWlnaHQKCiMjIE1vZGVsIHNwZWNpZmljYXRpb24KCiQkCnlfaT1cYmV0YV8wK1xiZXRhX2QgeF9kICsgXGJldGFfZyB4X2cgK1xiZXRhX3tkOmd9IHhfZCB4X2crIFxlcHNpbG9uX2ksCiQkCgp3aXRoICRcZXBzaWxvbl9pIFx0ZXh0eyBpLmkuZC4gfSBOKDAsXHNpZ21hXjIpJAoKIyMgQXNzdW1wdGlvbnMKClRoZSBtb2RlbCB3aWxsIGFnYWluIGJlIGZpdCB0byBhbGxvdyBmb3IgYXNzZXNzaW5nIHRoZSBtb2RlbCBhc3N1bXB0aW9ucwoKYGBge3J9CiMgbG1fSW50IDwtIGxtKGxvZzJTdXJ2X3RpbWUgfiBEb3NlK1dlaWdodCtEb3NlOldlaWdodCwgZGF0YSA9IHBvaXNvbl9kb2pvKSAjIGVxdWl2YWxlbnQKbG1fSW50IDwtIGxtKGxvZzJTdXJ2X3RpbWUgfiBEb3NlKldlaWdodCwgZGF0YSA9IHBvaXNvbl9kb2pvKSAjICogLT4gc2hvcnQgbm90YXRpb24KCnBhcihtZnJvdz1jKDIsMikpCnBsb3QobG1fSW50KQpgYGAKCkFsbCBhc3N1bXB0aW9uIGFyZSAqKm1ldCoqLgoKIyMgSW5mZXJlbmNlCgpXZSB0aGVuIGluc3BlY3QgdGhlIHJlc3VsdHMuCgpgYGB7cn0Kc3VtbWFyeShsbV9JbnQpCmBgYAoKIyMgSW50ZXJwcmV0YXRpb24gb2YgbW9kZWwgcGFyYW1ldGVycwoKV2UgbWF5IGludGVycHJldCB0aGUgZXN0aW1hdGUgcGFyYW1ldGVycyBhcyBmb2xsb3dzOgoKLSBGb3IgYSBmaXNoIHdpdGggd2VpZ2h0ICR4X2ckLCB0aGUgZXhwZWN0ZWQgbG9nMiBzdXJ2aXZhbCB0aW1lIHdpbGwgYmUgCiRcYmV0YV9kK1xiZXRhX3tkOmd9KnhfZyQgaGlnaGVyIHdoZW4gdGhlIHBvaXNvbiBkb3NlIGlzIGluY3JlYXNlZCB3aXRoIDEgbWcvTCwKYXMgY29tcGFyZWQgdG8gZmlzaCB3aXRoIHRoZSBzYW1lIHdlaWdodC4KCi0gRm9yIGEgd2lzaCB0aGF0IHdhcyBleHBvc2VkIHRvIGRvc2UgJHhfZyQsIHRoZSBleHBlY3RlZCBsb2cyIHN1cnZpdmFsIHRpbWUgCndpbGwgYmUgICRcYmV0YV9kK1xiZXRhX3tkOmd9KnhfZyQgaGlnaGVyIGZvciBhIGZpc2ggd2l0aCBhIHdlaWdodCB0aGF0IGlzCjEgZ3JhbSBoaWdoZXIgdGhhbiB0aGF0IG9mIGFub3RoZXIgZmlzaC4KClRoZSBwYXJhbWV0ZXIgJFxiZXRhX3tkOmd9JCBjYW4gdGh1cyBiZSBpbnRlcnByZXRlZCBpbiB0d28gd2F5cy4gVGhlIGVhc2llc3QKb25lIGlzIHRoYXQgdGhlIGVmZmVjdCBvZiBkb3NlIG9uIHRoZSBsb2cyIHN1cnZpdmFsIHRpbWUgaXMgZGVwZW5kZW50IG9uIHRoZQp3ZWlnaHQgb2YgdGhlIGZpc2guIEFsdGVybmF0aXZlbHksIGl0IGNhbiBhbHNvIGJlIGludGVycHJldGVkIGFzIHRoZSBlZmZlY3QKb2Ygd2VpZ2h0IG9uIHRoZSBsb2cyIHN1cnZpdmFsIHRpbWUgYmVpbmcgZGVwZW5kZW50IG9uIHRoZSBkb3NlIHRoYXQgd2FzCmFkbWluaXN0ZXJlZC4KCiMjIEluZmVyZW5jZQoKVGhlIGVmZmVjdCBvZiBkb3NlIGlzIG5vdyBwYXJhbWV0ZXJpemVkIGJ5IHR3byBtb2RlbCBwYXJhbWV0ZXJzICgkXGJldGFfZCQgCmFuZCAkXGJldGFfe2Q6Z30kKS4gV2UgZmlyc3QgZXZhbHVhdGUgYW4gKm9tbmlidXMqIGh5cG90aGVzZXMgdGhhdCB0aGVyZSBpcwpubyBlZmZlY3Qgb2YgZG9zZSwgaS5lLiwgbm8gbWFpbiBlZmZlY3Qgbm9yIGFuIGludGVyYWN0aW9uIGVmZmVjdC4gV2UgY2FuIHRlc3QKdGhpcyB3aXRoIGFhbiBGLXRlc3QgdGhhdCBjb21wYXJlcyBhICpmdWxsKiBtb2RlbCAoMSkgY29udGFpbmluZyBhIG1haW4gZWZmZWN0IApmb3IgZG9zZSwgYSBtYWluIGVmZmVjdCBmb3Igd2VpZ2h0IGFuZCBhbiBpbnRlcmFjdGlvbiBiZXR3ZWVuIGRvc2UgYW5kIHdlaWdodAp3aXRoIGEgbW9kZWwgKDIpIHRoYXQgb25seSBjb250YWlucyBhIG1haW4gZWZmZWN0IGZvciB3ZWlnaHQgKGkuZS4gbm8gZWZmZWN0CmZvciBkb3NlKS4KCmBgYHtyfQojbG1Eb2pvX3dlaWdodCA8LSBsbShsb2cyU3Vydl90aW1lIH4gRG9zZSpXZWlnaHQsIGRhdGEgPSBwb2lzb25fZG9qbykKbG1Eb2pvX3dlaWdodCA8LSBsbShsb2cyU3Vydl90aW1lIH4gV2VpZ2h0LCBkYXRhID0gcG9pc29uX2Rvam8pCmFub3ZhKGxtRG9qb193ZWlnaHQsIGxtX0ludCkKYGBgCgpXZSBvYnNlcnZlIGFuIGV4dHJlbWVseSBzaWduaWZpY2FudCAob3ZlcmFsbCwgb3IgZ2xvYmFsKSBlZmZlY3QgZm9yIGRvc2Ugb24gCnRoZSBsb2cyIHN1cnZpdmFsIHRpbWUgb2YgZG9qb2Zpc2ggCihwLXZhbHVlID0gYHIgZm9ybWF0KGFub3ZhKGxtRG9qb193ZWlnaHQsIGxtX0ludClbMiw2XSxkaWdpdHM9MylgLgoKIyMgQ29udmVudGlvbmFsIGFwcHJvYWNoCgpXZSBhbHJlYWR5IGVzdGJhbGlzaGVkIHRoYXQgdGhlcmUgaXMgYSBzaWduaWZpY2FudCBvdmVyYWxsIGVmZmVjdCBvZiBkb3NlLgpOb3csIHdlIHdpbGwgdGVzdCBpZiB0aGVyZSBpcyBhIHNpZ25pZmljYW50IGludGVyYWN0aW9uIGVmZmVjdCBiZXR3ZWVuIGRvc2UgCmFuZCB3ZWlnaHQuIFNpbmNlIHdlIG9ubHkgaGF2ZSBvbmUgaW50ZXJhY3Rpb24gdGVybSBpbiB0aGlzIG1vZGVsLCB0aGlzIGNhbgpiZSBhY2hpZXZlZCBpbiBzZXZlcmFsIHdheXM6CgoxLiBUaGUgYHN1bW1hcnlgIGZ1bmN0aW9uCjIuIEFuIEYtdGVzdCBjb21wYXJpbmcgbW9kZWxzIHdpdGggYW5kIHdpdGhvdXQgdGhlIGludGVyYWN0aW9uIGVmZmVjdAozLiBBbiBBTk9WQSB0YWJsZSB3aXRoIHR5cGUgSUlJIHN1bSBvZiBzcXVhcmVzICAKCgpgYGB7cn0Kc3VtbWFyeShsbV9JbnQpICMxCmFub3ZhKGxtX2FkZGl0aXZlLGxtX0ludCkgIzIKQW5vdmEobG1fSW50LHR5cGU9IklJSSIpICMzCmBgYAoKVGhlcmUgaXMgbm8gc2lnbmlmaWNhbnQgaW50ZXJhY3Rpb24gYmV0d2VlbiBkb3NlIGFuZCB3ZWlnaHQuIEFzIHN1Y2gsIHRoZQplZmZlY3Qgb2YgZG9zZSBvbiBzdXJ2aXZhbCBpcyBub3Qgc2lnbmlmaWFudGx5IGRpZmZlcmVudCBiZXR3ZWVuIGZpc2ggb2YKZGlmZmVyZW50IHdlaWdodC4KClRoZSBjb252ZW50aW9uYWwgYXBwcm9hY2ggaXMgdG8gbm93IHJlbW92ZSB0aGUgaW50ZXJhY3Rpb24gZWZmZWN0IGZyb20gdGhlIAptb2RlbC4gQXMgc3VjaCwgd2UgYXJlIGxlZnQgd2l0aCB0aGUgYWRkaXRpdmVlIGxpbmVhciByZWdyZXNzaW9uIG1vZGVsCmBsbV9hZGRpdGl2ZWAgdGhhdCB3ZSBoYXZlIGFscmVhYWR5IGZpdHRlZCBhYm92ZS4KCmBgYHtyfQpzdW1tYXJ5KGxtX2FkZGl0aXZlKQpgYGAKCmBgYHtyfQoyXihsbV9hZGRpdGl2ZSRjb2VmKSAjIG9yaWdpbmFsIHNjYWxlCjJeKGNvbmZpbnQobG1fYWRkaXRpdmUpKQpgYGAKCiMjIyBDb25jbHVzaW9uCgpUaGUgY29uY2x1c2lvbiBpcyBleGFjdGx5IHRoZSBzYW1lIGFzIGZvciB0aGUgYWRkaXRpdmUgbW9kZWwgYW5hbHlzaXMgYWJvdmUgCihvYnZpb3VzbHksIGFzIHdlIGFyZSBkZWFsaW5nIHdpdGggdGhlIHNhbWUgbW9kZWwpOgoKVGhlIGRvc2Ugb2YgdGhlIHBvaXNvbiBoYXMgYW4gZXh0cmVtZWx5IHNpZ25pZmljYW50IGVmZmVjdCBvbiB0aGUgc3Vydml2YWwgdGltZQpvZiBkb2pvZmlzaCAKKHAtdmFsdWUgPSBgciBmb3JtYXQoc3VtbWFyeShsbV9hZGRpdGl2ZSkkY29lZmZpY2llbnRzWzIsNF0sZGlnaXRzPTMpYCkuIFRoZQpnZW9tZXRyaWMgYXZlcmFnZSBvZiB0aGUgc3Vydml2YWwgdGltZSBvZiBkb2pvZmlzaCBpcyByZWR1Y2VkIChhcHByb3hpbWF0ZWx5CmhhbGZlZCwgCmZhY3RvciA9ICQyXntcYmV0YV9kfT0kIGByIGZvcm1hdCgyXihsbV9hZGRpdGl2ZSRjb2VmWyJEb3NlIl0pLGRpZ2l0cz0zKWApIGlmCnRoZSBkb3NlIG9mIHBvaXNvbiBpcyBpbmNyZWFzZWQgd2l0aCAxIG1nL0wgCig5NSUgQkkgW2ByIHBhc3RlKGZvcm1hdCgyXihjb25maW50KGxtX2FkZGl0aXZlKVsiRG9zZSIsXSksZGlnaXRzPTMpLGNvbGxhcHNlPSIsIilgXSkuCgpUaGUgZWZmZWN0IG9mIGRvc2Ugb24gc3Vydml2YWwgaXMgbm90IHNpZ25pZmlhbnRseSBkaWZmZXJlbnQgYmV0d2VlbiBmaXNoIG9mCmRpZmZlcmVudCB3ZWlnaHQuIChwID0gYHIgZm9ybWF0KHN1bW1hcnkobG1fSW50KSRjb2VmZmljaWVudHNbNCw0XSwgZGlnaXRzPTIpYCkuCgojIyBBbHRlcm5hdGl2ZSBhcHByb2FjaAoKQWx0ZXJuYXRpdmVseSwgd2UgbWF5IHBlcmZvcm0gYW4gYW5hbHlzaXMgd2l0aG91dCByZW1vdmluZyB0aGUgaW50ZXJhY3Rpb24gCmVmZmVjdC4KCmBgYHtyfQpzdW1tYXJ5KGxtX0ludCkKYGBgCgpUaGUgaW50ZXJhY3Rpb24gZWZmZWN0IGlzIG5vdCBzaWduaWZpY2FudCwgc28gd2Ugd291bGQgYWNjZXB0IHRoZSBudWxsCmh5cG90aGVzaXMgdGhhdCB0aGVyZSBpcyBubyBpbnRlcmFjdGlvbiBlZmZlY3QuIEhvd2V2ZXIsIGFjY2VwdGluZyBhIG51bGwKaHlwb3RoZXNpcyBpcyBhICoqd2VhayBjb25sdXNpb24qKi4gSW4gYWRkaXRpb24sIHdlIGtub3cgdGhhdCB0aGUgKipwb3dlciB0byoqCioqZmluZCBhbiBpbnRlcmFjdGlvbiBlZmZlY3QgaXMgbG93KiouIEFzIHN1Y2gsIHdlIG1heSBzdGlsbCB3YW50IHRvIGluY2x1ZGUKYW4gaW50ZXJhY3Rpb24gZWZmZWN0IGluIHRoZSBtb2RlbCAoaWYgd2Ugd2FudCB0byBwbGF5IHNhZmUpLgoKV2l0aCB0aGlzIG1vZGVsLCB3ZSBjb3VsZCBzdGlsbCBzYXkgc29tZXRoaW5nIGFib3V0IHRoZSBhdmVyYWdlIGRvc2lzIGVmZmVjdApmb3IgdGhlIGRvam9maXNoIGluIHRoaXMgZXhwZXJpbWVudC4gVGhpcyB3b3VsZCByZXF1aXJlIHVzIHRvICoqbWFyZ2luYWxpemUqKgphY2Nyb3MgYWxsIGRvam9maXNoIGluIHRoZSBleHBlcmltZW50LCBpLmUuLAoKJCQKXGZyYWN7XHN1bVxsaW1pdHNfe2k9MX1ee25fXHRleHR7ZG9qb319IChcYmV0YV9kICsgXGJldGFfe2Q6d30geF97aXd9KX17bl9cdGV4dHtkb2pvfX0gPSBcYmV0YV9kICsgXGJldGFfe2Q6d30gXGJhcnt4fV93CiQkCgpJbiBvdGhlciB3b3Jkcywgd2UgYXJlZSBlc3RpbWF0aW5nIHRoZSBkb3NlIGVmZmVjdCBmb3IgCioqInRoZSBhdmVyYWdlIGRvam9maXNoIioqIGluIHRoZSBleHBlcmltZW50LgoKYGBge3J9CndCYXIgPC0gcG9pc29uICU+JQogIHB1bGwoV2VpZ2h0KSAlPiUKICBtZWFuCndCYXIKYGBgCgpUaGUgYXZlcmFnZSB3ZWlndGggZm9yIGEgZG9qb2Zpc2ggaW4gdGhpcyBleHBlcmltZW50IGlzCmByIHJvdW5kKHdCYXIsIDIpYCBncmFtcy4KCldlIG5vdyBldmFsdWF0ZSB0aGUgY29udHJhc3QgZm9yIHRoZSBtYXJnaW5hbCBkb3NlIGVmZmVjdCwgaS5lLiwgaWYKJFxiZXRhX2QrMi4xMzEzKlxiZXRhX3tkOmd9JCBpcyBzaWduaWZpY2FudGx5IGRpZmZlcmVudCBmcm9tIHplcm8uCgpgYGB7cn0KbWFyZ2luYWxEb3Npc0VmZmVjdCA8LSBnbGh0KGxtX0ludCwgbGluZmN0ID0gYygiRG9zZSArIDIuMTMxMypEb3NlOldlaWdodCA9IDAiKSkKc3VtbWFyeShtYXJnaW5hbERvc2lzRWZmZWN0KQpgYGAKCmBgYHtyfQpjb25maW50KG1hcmdpbmFsRG9zaXNFZmZlY3QpCjJeY29uZmludChtYXJnaW5hbERvc2lzRWZmZWN0KSRjb25maW50CmBgYAoKKiohIG5vdGljZSB0aGF0IHRoZSBtYXJnaW5hbCBkb3NpcyBlZmZlY3QgaXMgYWxtb3N0IGV4YWN0bHkgdGhlIHNhbWUgYXMgdGhlKioKKiplZmZlY3QgdGhhdCB3YXMgZXN0aW1hdGVkIGZvciB0aGUgbW9kZWwgd2l0aG91dCB0aGUgaW50ZXJhY3Rpb24gZWZmZWN0ISoqCgojIyMgQ29uY2x1c2lvbgoKV2Ugb2JzZXJ2ZSBhbiBleHRyZW1lbHkgc2lnbmlmaWNhbnQgKG92ZXJhbGwsIG9yIGdsb2JhbCkgZWZmZWN0IGZvciBkb3NlIG9uIAp0aGUgbG9nMiBzdXJ2aXZhbCB0aW1lIG9mIGRvam9maXNoIAoocC12YWx1ZSA9IGByIGZvcm1hdChhbm92YShsbURvam9fd2VpZ2h0LCBsbV9JbnQpWzIsNl0sZGlnaXRzPTMpYC4KCgpUaGUgZWZmZWN0IG9mIGRvc2Ugb24gc3Vydml2YWwgaXMgbm90IHNpZ25pZmlhbnRseSBkaWZmZXJlbnQgYmV0d2VlbiBmaXNoIG9mCmRpZmZlcmVudCB3ZWlnaHQuIChwID0gYHIgZm9ybWF0KHN1bW1hcnkobG1fSW50KSRjb2VmZmljaWVudHNbNCw0XSwgZGlnaXRzPTIpYCkuCgpUaGUgbWFyZ2luYWwgZ2VvbWV0cmljIGF2ZXJhZ2Ugb2YgdGhlIGxvZzIgc3Vydml2YWwgYXBwcm94aW1hdGVlbHkgaGFsdmVzIAooZmFjdG9yID0gYHIgZm9ybWF0KCAyXmNvbmZpbnQobWFyZ2luYWxEb3Npc0VmZmVjdCkkY29uZmludFsxLDFdLCBkaWdpdHM9MylgKQpmb3IgZmlzaCB0aGF0IGFyZSBzdWJqZWN0ZCB0byBhIGRvc2UgdGhhdCBpcyAxIG1nL0wgaGlnaGVyCig5NSUgQ0kgW2ByIHBhc3RlKGZvcm1hdCgyXmNvbmZpbnQobWFyZ2luYWxEb3Npc0VmZmVjdCkkY29uZmludFsxLC0xXSxkaWdpdHM9MyksY29sbGFwc2U9IiwgIilgXSksIGFmdGVyIGNvcnJlY3Rpb24gZm9yIHdlaWdodAoocC12YWx1ZSA9IGByIGZvcm1hdChzdW1tYXJ5KG1hcmdpbmFsRG9zaXNFZmZlY3QpJHRlc3QkcHZhbHVlc1sxXSxkaWdpdHM9MylgLgoKCgoKCgoK</div>
<div class="footer">
    <hr>
    This work is licensed under the <a href= "https://creativecommons.org/licenses/by-nc-sa/4.0">
    CC BY-NC-SA 4.0</a> licence.
</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("08_x_poison1_sol.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>

---
title: "Exercise 8.x: Blocking on the captopril dataset"   
author: "Lieven Clement and Jeroen Gilis"
date: "statOmics, Ghent University (https://statomics.github.io)"  
output:
    html_document:
      code_download: true    
      theme: cosmo
      toc: true
      toc_float: true
      highlight: tango
      number_sections: true
---

# Background 

Researchers want to assess the effect of captopril on blood pressure of 
patients with hypertension. They select 15 hypertension patients at random from 
participants who gave consent to participate in a clinical trial. 
They measure the systolic and diasystolic blood pressure before and after t
reating them with captopril. Hence, we have a randomized complete block (RCB) 
design with patient as block factor, i.e. every patient serves as its own 
control.

In this exercise, we will focus only on the systolic blood pressure. Our goal
is to determine if the captopril treatment was succesful in lowering the
systolic blood pressure.

Load libraries

```{r, message=FALSE, warning=FALSE}

```

# Data import

```{r}

```

# Data exploration

Note that we already explore this dataset in the exercise session on
hypothesis testing. If you want, you may copy paste your data exploration from
that file here.

```{r}

```

# Analysis 1: paired t-test

Again, we already performed this analysis in the chapter of hypothesis testing.
If you want, you may copy paste your data exploration from that file here.

```{r}

```

# Analysis 2: Linear regression without blocking (incorrect)

Next, we may try to answer the same research question using linear regression.
However, imagine we perform an analysis that uses `type` as the only predictor
variable for blood pressure. Note that such an analysis does not account for 
the fact that measurements of the same individual are correlated, hence 
violating one of the assumptions for linear regression!

```{r}
# fit the model to first assess the model assumptions

```

```{r}
# perform the hypothesis test using the `summary` function

```

Compare the result for the point estimate of the captopril effect between
the paired t-test analysis and this linear regression analysis.

In addition, compare the result for the standard error on this estimate
between both analyses.

Can you explain what is happening here?



# Analysis 3: Linear regression with blocking (correct)

Here, we will adjust the regression model formula to analyse the captopril 
experiment as a randomized complete block design. 

```{r}
# fit the model to first assess the model assumptions

```

```{r}
# perform the hypothesis test using the `summary` function

```

Compare the result for the point estimate of the captopril effect between
the three analyses.

In addition, compare the result for the standard error on this estimate effect 
between the three analyses.

Can you explain what is happening here?


